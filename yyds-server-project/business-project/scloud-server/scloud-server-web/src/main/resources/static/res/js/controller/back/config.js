scloudApp.controller("backConfigController",["$scope","$rootScope","treeService","enterpriseService","deviceService","fileUploadService",function(e,i,n,t,l,r){function o(){e.isLoading2=!0,n.getAllTierTree(e.currentEnterprise.uniqueCode,function(i){e.isLoading2=!1,e.zTree=n.createZTree(i),n.initTree(e.zTree.zNodes,"areaTree","simpleTierTree")},function(){e.isLoading2=!1,e.zTree.zNodes=null,e.zTree.isEmpty=!0})}function a(){e.isLoading3=!0,l.getDeviceTypeList(e.currentEnterprise.uniqueCode,function(i){e.isLoading3=!1,e.deviceTypeList=i},function(){e.isLoading3=!1})}$state&&($state=window.$state),$stateParams&&($stateParams=window.$stateParams),e.importTierTree={form:{},obj:{},toModal:null,execute:null,select:null,clear:null,loading:!1},e.setDefaultTier={toModal:null,execute:null,clear:null,loading:null},e.importDeviceSignalType={form:{},obj:{},toModal:null,execute:null,select:null,clear:null,loading:!1},e.isLoading=!1,e.isLoading2=!1,e.isLoading3=!1,e.isPhoneExist=!1,e.setModuleEnbale=function(e,i,n){switch(n.stopPropagation(),i){case"MONITOR":t.setModuleEnbale(e.enterprise.id,i,!e.enableMonitor,function(){e.enableMonitor=!e.enableMonitor});break;case"ENTRANCE":t.setModuleEnbale(e.enterprise.id,i,!e.enableEntrance,function(){e.enableEntrance=!e.enableEntrance});break;case"BATTERY":t.setModuleEnbale(e.enterprise.id,i,!e.enableBattery,function(){e.enableBattery=!e.enableBattery});break;case"WORK":t.setModuleEnbale(e.enterprise.id,i,!e.enableWork,function(){e.enableWork=!e.enableWork})}},e.getCurrentEnterprise=function(i){e.currentEnterprise!==i&&(e.currentEnterprise=i,o(),a())},e.importTierTree.toModal=function(i){$("#importTierTreeModal").modal("show"),e.fileUpload=r.getFileUpload(),e.isImportDefaultTierTree=i},e.importTierTree.select=function(){e.fileUpload.selectFile("fileUploadBtn")},e.importTierTree.execute=function(){var n="";n=e.isImportDefaultTierTree?"/systemFunc/importTierTree":"/systemFunc/importTierTree?uniqueCode="+e.currentEnterprise.uniqueCode,e.fileUpload.upload(n,function(n){if(e.importTierTree.clear(),e.importTierTree.loading=!1,!1===n.success)return void i.notify({type:"error",text:n.info});i.notify({type:"success",text:"导入站点分级成功"}),!e.isImportDefaultTierTree&&o()},function(){e.importTierTree.clear(),e.importTierTree.loading=!1,console.log("导入站点分级失败")}),e.importTierTree.loading=!0},e.importTierTree.clear=function(){$("#importTierTreeModal").modal("hide"),e.fileUpload.files=null,e.fileUpload.info={id:null,name:null,url:null,size:null,progress:null}},e.setDefaultTier.toModal=function(){$("#setDefaultTierModal").modal("show")},e.setDefaultTier.execute=function(){n.setDefaultTierTree(e.currentEnterprise.uniqueCode,function(){e.setDefaultTier.clear(),e.setDefaultTier.loading=!1,o()}),e.setDefaultTier.loading=!0},e.setDefaultTier.clear=function(){$("#setDefaultTierModal").modal("hide")},e.importDeviceSignalType.toModal=function(i){$("#importDeviceSignalTypeModal").modal("show"),e.fileUpload=r.getFileUpload(),e.isImportDefaultDeviceSignalType=i},e.importDeviceSignalType.select=function(){e.fileUpload.selectFile("fileUploadBtn2")},e.importDeviceSignalType.execute=function(){var n="";n=e.isImportDefaultDeviceSignalType?"/systemFunc/importSignalType":"/systemFunc/importSignalType?uniqueCode="+e.currentEnterprise.uniqueCode,e.fileUpload.upload(n,function(n){if(e.importDeviceSignalType.clear(),e.importDeviceSignalType.loading=!1,!1===n.success)return void i.notify({type:"error",text:n.info});i.notify({type:"success",text:"导入映射表成功"}),!e.isImportDefaultDeviceSignalType&&a()},function(){e.importDeviceSignalType.clear(),e.importDeviceSignalType.loading=!1,console.log("导入映射表失败")}),e.importDeviceSignalType.loading=!0},e.importDeviceSignalType.clear=function(){$("#importDeviceSignalTypeModal").modal("hide"),e.fileUpload.files=null,e.fileUpload.info={id:null,name:null,url:null,size:null,progress:null}},function(){e.isLoading=!0,t.getEnterpriseList(function(i){e.isLoading=!1,e.enterpriseList=i},function(){e.isLoading=!1})}()}]);