scloudApp.controller("dataDebugController",["$scope","$rootScope","siteService","deviceService","signalService","alarmService","initService","treeService",function(e,i,t,n,o,a,r,c){function s(t){var n=c.getCheckedNode(t);if(!n)return i.notify({type:"warn",text:"请选择一个站点"}),void(e.currentSite=null);e.currentSite=n,u()}function u(){e.currentSite&&(e.isLoading=!0,n.getDeviceListOnSite(e.currentSite.id,e.paginationConf,e.deviceQuery,function(i){e.isLoading=!1,e.deviceList=i.list,e.paginationConf.totalItems=i.count},function(){e.isLoading=!1}))}function d(){if(e.curDevice){e.isSignalLoading=!0;var t=i.CONST.signalType.list[1];e.signalList=[],o.getSignalList(e.curDevice.id,{type:t},function(i){e.isSignalLoading=!1,e.signalList=i.signalDIList},function(){e.isSignalLoading=!1})}}$state&&($state=window.$state),$stateParams&&($stateParams=window.$stateParams),e.deviceQuery={},e.systemList={},e.isLoading=!1,e.paginationConf={currentPage:1,itemsPerPage:15,pagesLength:9,onChange:function(){}},e.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",u),e.searchKey={online:!0,offline:!0,keyword:""},e.getNodesByParamFuzzy=function(){setTimeout(function(){e.zTree.getNodesByParamFuzzy(e.searchKey,"areaTree","radioSiteTree",function(){s("areaTree")})},10)},e.query=function(){u()},e.reset=function(){e.deviceQuery={}},e.openDevice=function(i){e.curDevice=i,d()},e.refresh=function(){d()},e.setThreshold={obj:{},toModal:function(e){$("#setThresholdModal").modal("show"),this.obj=e},execute:function(){var e=this;e.loading=!0,o.modifyThreshold(e.obj,function(){e.loading=!1,e.clear(),d()},function(){e.loading=!1})},clear:function(){this.obj={},$("#setThresholdModal").modal("hide")}},function(){e.treeLoading=!0,c.getSiteMapTree({},function(i){e.treeLoading=!1,e.zTree=c.createZTree(i),c.initTree(e.zTree.zNodes,"areaTree","radioSiteTree",function(){s("areaTree")}),c.checkNodeBySiteId("areaTree")})}(),function(){n.getSystemNameList(null,function(i){e.systemList=i})}(),function(i){n.getDeviceTypeList(i,function(i){e.deviceTypeList=i})}()}]);