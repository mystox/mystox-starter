scloudApp.controller("backCenterController",["$scope","$rootScope","enterpriseService","verifyCodeService","userService",function(e,n,o,i,t){function r(){e.isLoading=!0,o.getEnterpriseStatList(function(n){e.isLoading=!1,e.enterpriseList=n;for(var o=[n.length,0,0,0,0],i=0;i<n.length;i++)o[1]+=n[i].countUser,o[2]+=n[i].countOnlineFsu,o[3]+=n[i].countFsu,o[4]+=n[i].countPoint;e.counts=o},function(){e.isLoading=!1})}$state&&($state=window.$state),$stateParams&&($stateParams=window.$stateParams),e.isLoading=!1,e.isPhoneExist=!1,e.isUniqueCodeExist=!1,e.isUsernameExist=!1,e.refreshIntervals=[-1,2,10,120,300],e.addEnterprise={form:{},obj:{},toModal:null,execute:null,clear:null},e.modifyEnterprise={form:{},obj:{},toModal:null,execute:null,clear:null},e.addEnterprise.toModal=function(){$("#addEnterpriseModal").modal("show"),e.addEnterprise.obj.pollingInterval=30,e.addEnterprise.obj.refreshInterval=300,e.addEnterprise.obj.fsuOfflineDelayTime=30},e.addEnterprise.execute=function(){$("#addEnterpriseModal").modal("hide"),o.addEnterprise(e.addEnterprise.obj,function(o){t.addUser({username:e.addEnterprise.obj.username,password:e.addEnterprise.obj.password,phone:e.addEnterprise.obj.contactsPhone,email:e.addEnterprise.obj.contactsEmail,name:e.addEnterprise.obj.contactsName,department:null,classes:n.CONST.userClasses.enterprise,type:n.CONST.userType.globalManager,userGroup:null,companyId:o.id},function(){r(),e.addEnterprise.clear()})})},e.addEnterprise.clear=function(){e.addEnterprise.form.$setPristine(),e.addEnterprise.obj={},$("#addEnterpriseModal").modal("hide")},e.modifyEnterprise.toModal=function(e){this.obj=angular.copy(e),this.obj.fsuOfflineTemp=this.obj.fsuOfflineTemp||null,this.obj.createUserTemp=this.obj.createUserTemp||null,this.obj.alarmReportTemp=this.obj.alarmReportTemp||null,this.obj.alarmRecoverTemp=this.obj.alarmRecoverTemp||null,this.obj.phoneCodeTemp=this.obj.phoneCodeTemp||null,$("#modifyEnterpriseModal").modal("show")},e.modifyEnterprise.execute=function(){$("#modifyEnterpriseModal").modal("hide"),o.modifyEnterprise(e.modifyEnterprise.obj,function(){r(),e.modifyEnterprise.clear()})},e.modifyEnterprise.clear=function(){e.modifyEnterprise.form.$setPristine(),e.modifyEnterprise.obj={},$("#modifyEnterpriseModal").modal("hide")},e.checkUniqueCode=function(n){e.uniqueCodeExistInfo="",o.checkUniqueCode(n,function(n){e.isUniqueCodeExist=!n.success,e.uniqueCodeExistInfo=n.info})},e.checkUsername=function(n){e.usernameInfo="",t.checkUsername(n,function(n){e.isUsernameExist=!n.success,e.usernameExistInfo=n.info})},e.checkPhoneExist=function(n){e.phoneExistInfo="",i.checkPhoneExist(n,function(n){e.isPhoneExist=!n.success,e.phoneExistInfo=n.info})},e.intoEnterprise=function(i){o.intoEnterprise(i,function(o){e.getNavInfo(function(){location.hash="#"+o,n.util.browserInfo.isIE&&window.location.reload()},"#"+o)})},r(),function(){e.agencyList=[],o.getAgencyList(function(n){e.agencyList=n})}()}]);