Scene3D.prototype.modelFileFn.airCon=function(e){var o={size:{x:4,y:2},name:{type:"airCon"},height:17.443,class:["obj","airCon"],once:!0,isDevice:!0,shadowPath:[[-2.3,-1.3],[2.3,-1.3],[2.3,1.1],[-2.3,1.1]],afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("airCon",o,"普通空调"),void e(o)}scene3D.loadModel("airCon",o,"普通空调");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadObj("airCon",scene3D.setting.ctx+"/obj/airCon.obj",n,[2.5,2.5,2.5]),scene3D.loadTex(scene3D.setting.ctx+"/img/airCon.jpg",n,function(e){scene3D.loadMat("airCon",new THREE.MeshLambertMaterial({map:e,color:"#f2f2f2"}))})},Scene3D.prototype.modelFileFn.airCon_embed=function(e){var o={size:{x:1,y:1},name:{type:"airCon_embed"},height:8/3,above:0,class:["obj","airCon_embed"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,beforeMoving:function(e){e&&(e.occupied=!0)},onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.parent.position.x,this.parent.position.y,this.parent.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("airCon_embed",o,"普通空调","嵌入式空调"),void e(o)}scene3D.loadModel("airCon_embed",o,"普通空调","嵌入式空调");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)};var t=new THREE.BoxGeometry(1/3,8/3,2);t.setUV([[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[0,0],[1,0],[1,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]),scene3D.loadTex(scene3D.setting.ctx+"/img/airCon_embed.jpg",n,function(e){scene3D.loadMat("airCon_embed",new THREE.MeshLambertMaterial({map:e,color:"#888"}))}),scene3D.loadGeo("airCon_embed",t)},Scene3D.prototype.modelFileFn.battery=function(e){var o={size:{x:10,y:4},name:{type:"battery"},height:9.5,class:["obj","battery"],once:!0,isDevice:!0,flipable:!0,shadowPath:[[-9.7,-3.75],[9.7,-3.75],[9.7,3.75],[-9.7,3.75]],showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,onCreate:function(){this.castShadow=!0;var e=scene3D.geometries.geometry_battery24,o=scene3D.materials.material_battery24.clone(),n={type:"toDelete",class:"beam"},t=new THREE.Mesh(e,o);t.rotation.y=.5*Math.PI,t.scale.set(2.7,2.3,2.8),t.position.y=-.5,t.name=n,t.castShadow=!0,this.add(t),t=t.clone(),t.position.y=2.5,t.name=n,this.add(t),t=t.clone(),t.position.y=-3.5,t.name=n,this.add(t)},afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.position.toArray().concat(.5))},beforeCancelSelected:function(){this.children.forEach(function(e){"Sprite"!==e.type&&e.highlight("#7d92b6")})},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("battery",o,"蓄电池组"),void e(o)}scene3D.loadModel("battery",o,"蓄电池组");var t=new THREE.BoxGeometry(2.7,1,6.8);t.setUV([[.901,0],[.901,.1],[.9,.1],[.9,0],[.5,1.002],[.75,1.002],[.75,.002],[.5,.002],[.75,1],[1,1],[1,0],[.75,0],[.9,0],[.9,.1],[.909,.1],[.909,0],[0,1],[.492,1],[.492,0],[0,0],[.9,0],[.9,.01],[.909,.01],[.909,0]]),scene3D.loadGeo("battery24",t),scene3D.loadTex(scene3D.setting.ctx+"/img/battery24.jpg",n,function(e){scene3D.loadMat("battery24",new THREE.MeshPhongMaterial({color:"#7d92b6",specular:16777215,map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))}),scene3D.loadObj("battery",scene3D.setting.ctx+"/obj/battery24.obj",n,[1.95,2,1.9]),scene3D.loadMat("battery",new THREE.MeshPhongMaterial({color:"#0c0d0d",shininess:100,specular:16777215}))},Scene3D.prototype.modelFileFn.battery_embed=function(e){var o={size:{x:1,y:1},name:{type:"battery_embed"},height:2,class:["obj","battery_embed"],once:!0,isDevice:!0,flipable:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,beforeMoving:function(e){e&&(e.occupied=!0)},onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.parent.position.toArray().concat(.5))}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("battery_embed",o,"蓄电池组","嵌入式蓄电池组"),void e(o)}scene3D.loadModel("battery_embed",o,"蓄电池组","嵌入式蓄电池组");var t=new THREE.BoxGeometry(1,2,3);t.setUV([[.6,1],[.6,0],[.8,0],[.8,1],[0,1],[0,0],[.58,0],[.58,1],[0,1],[0,0],[.58,0],[.58,1],[.6,1],[.6,0],[.8,0],[.8,1],[.8,0],[1,0],[1,1],[.8,1],[.4,.4],[.4,.4],[.4,.4],[.4,.4]]),scene3D.loadGeo("battery_embed",t),scene3D.loadTex(scene3D.setting.ctx+"/img/battery_embed.jpg",n,function(e){scene3D.loadMat("battery_embed",new THREE.MeshPhongMaterial({specular:16777215,map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.BBDS=function(e){var o={size:{x:2,y:1},name:{type:"BBDS"},height:3,class:["obj","BBDS"],once:!0,isDevice:!0,onWall:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){var e="Scene"===this.parent.type?this.position:this.parent.position;scene3D.camera.moveTo.apply(scene3D.camera,e.toArray().concat(.5)),this.parent.device&&"cabinet"===this.parent.device.type&&new TWEEN.Tween(this.position).to({x:3},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},beforeCancelSelected:function(){this.parent&&this.parent.device&&"cabinet"===this.parent.device.type&&new TWEEN.Tween(this.position).to({x:0},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.BoxGeometry(4,2.4,.5);n.setUV([[1,.25],[1,1],[0,1],[0,.25],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[1,.25],[0,.25],[0,0],[1,0],[0,0],[0,0],[0,0],[0,0]]);var t=new THREE.LoadingManager;switch(t.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("BBDS",o,"BBDS"),void e(o)}scene3D.loadModel("BBDS",o,"BBDS"),scene3D.loadGeo("BBDS",n),scene3D.loadTex(scene3D.setting.ctx+"/img/BBDS.jpg",t,function(e){scene3D.loadMat("BBDS",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.BBDSBattery=function(e){var o={size:{x:1,y:1},name:{type:"BBDSBattery"},height:.6,class:["obj","BBDSBattery"],once:!0,isDevice:!0,rotatable:!1,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){this.originPos&&this.position.copy(this.originPos),this.originPos=this.position.clone(),new TWEEN.Tween(this.position).to({y:this.position.y+1},500).easing(TWEEN.Easing.Sinusoidal.InOut).start(),scene3D.camera.moveTo.apply(scene3D.camera,this.parent.position.toArray().concat(.5))},beforeCancelSelected:function(){new TWEEN.Tween(this.position).to({y:this.originPos.y},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("BBDSBattery",o,"BBDS蓄电池组"),void e(o)}scene3D.loadModel("BBDSBattery",o,"BBDS蓄电池组"),scene3D.loadObj("BBDSBattery",scene3D.setting.ctx+"/obj/battery.obj",n,[1,1,.8]),scene3D.loadTex(scene3D.setting.ctx+"/img/BBDSBattery.jpg",n,function(e){scene3D.loadMat("BBDSBattery",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.cabinet=function(e){var o={size:{x:3,y:2},name:{type:"cabinet"},height:12,class:["obj","cabinet"],capacity:16,once:!1,isDevice:!1,itemsCanBeAdded:["cabinet","typeA","BBDS","FSU","BBDS","PDU"],shadowPath:[[-2.9,-1.9],[2.9,-1.9],[2.9,1.9],[-2.9,1.9]],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.device.childrenList=new scene3D.ChildrenList(this.device);var e=new THREE.Mesh(scene3D.geometries.geometry_cabinetDoor,scene3D.materials.material_cabinetDoor.clone());e.name={type:"toDelete",opacityPropagation:!0},this.add(e),e.position.x+=3,e.position.z+=2,this.door=e,this.door.onSelect=function(){this.rotation.y<0?this.ani=new TWEEN.Tween(this.rotation).to({y:0},500).easing(TWEEN.Easing.Sinusoidal.InOut).start():this.ani=new TWEEN.Tween(this.rotation).to({y:-.5*Math.PI},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()};var o=new THREE.Mesh(scene3D.geometries.geometry_cabinetDevice,scene3D.materials.material_cabinetDevice);o.nameForContainer="cabinetDevice",o.visible=0===this.device.childrenList.list.length,o.name={type:"toDelete",opacityPropagation:!0},this.add(o),this.castShadow=!0},showDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(this),scene3D.apply()},hideDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(!1),scene3D.apply()},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},beforeCancelSelected:function(){},privateRaycast:function(e,o){var n=o.length;this.door.raycast.call(this.door,e,o);var t;if(n<o.length){t=o[n];for(var i=!0,s=0;s<n;s++)if(o[s].distance<t.distance){i=!1;break}i&&(o.length=0,o.push(t))}},update:function(){this.device.childrenList.list.forEach(function(e,o){var n=scene3D.deviceToMesh[e.code];this.add(n),n.state="normal",n.nameTag.hide(),n.position.set(0,0,0),n.rotation.set(Math.PI/2,0,-Math.PI/2),n.position.x=1.6,n.position.y=.5*o-5.2}.bind(this)),this.children.filter(function(e){return e.nameForContainer})[0].visible=0===this.device.childrenList.list.length}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("cabinet",o,"机柜"),void e(o)}scene3D.loadModel("cabinet",o,"机柜");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/cabinetDoor.jpg",n,function(e){scene3D.loadMat("cabinetDoor",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.8}))});var t=new THREE.BoxGeometry(.2,12,4);t.setUV([[.001,0],[0,0],[0,.001],[.001,.001],[0,0],[0,1],[1,1],[1,0],[1,1],[1,0],[0,0],[0,1],[.001,0],[0,0],[0,.001],[.001,.001],[.001,0],[0,0],[0,.001],[.001,.001],[.001,0],[0,0],[0,.001],[.001,.001]]),t.translate(.1,0,-2),scene3D.loadGeo("cabinetDoor",t),scene3D.loadObj("cabinet",scene3D.setting.ctx+"/obj/cabinet.obj",n,[2,2,2]),scene3D.loadTex(scene3D.setting.ctx+"/img/cabinet.jpg",n,function(e){scene3D.loadMat("cabinet",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.8}))}),scene3D.loadGeo("cabinetDevice",new THREE.BoxGeometry(5,11,3)),scene3D.loadTex(scene3D.setting.ctx+"/img/cabinetDevice.jpg",n,function(e){scene3D.loadMat("cabinetDevice",new THREE.MeshLambertMaterial({map:e}))}),scene3D.recover.addRecover("allAddSymbol","v.remove(v.addSymbol); delete v.addSymbol")},Scene3D.prototype.modelFileFn.camera=function(e){var o={size:{x:1,y:1},name:{type:"camera"},height:2,above:20,class:["obj","camera"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,onCreate:function(){var e=new THREE.SphereGeometry(.8,32,16,0,2*Math.PI,.5*Math.PI,Math.PI),o=new THREE.MeshPhongMaterial({color:0,transparent:!0,opacity:.6,specular:16777215}),n=new THREE.Mesh(e,o);n.name={type:"toDelete"},this.lens=n,this.add(n)},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},toggleCameraSE:function(e){var o=scene3D.modelMethods.toggleCameraSE.call(this,e,null,60);o&&(o.position.y-=9*Math.cos(60/180*Math.PI))},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=[];n.push(new THREE.Vector2(0,0)),n.push(new THREE.Vector2(.84,0)),n.push(new THREE.Vector2(.88,.05*.8)),n.push(new THREE.Vector2(1,.1*.8)),n.push(new THREE.Vector2(1,.75*.8)),n.push(new THREE.Vector2(.98,.75*.8)),n.push(new THREE.Vector2(1,.775*.8)),n.push(new THREE.Vector2(1,.8)),n.push(new THREE.Vector2(0,.8)),n.push(new THREE.Vector2(0,0));var t=new THREE.LatheGeometry(n,64,0,2*Math.PI);switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("camera",o,"摄像头"),void e(o)}scene3D.loadModel("camera",o,"摄像头"),scene3D.loadGeo("camera",t),scene3D.loadMat("camera",new THREE.MeshLambertMaterial({color:"#e0f3ff"})),e(o)},Scene3D.prototype.modelFileFn.camera_ballshape=function(e){var o={size:{x:1,y:1},name:{type:"camera_ballshape"},height:2,above:20,class:["obj","camera_ballshape"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},toggleCameraSE:function(e){var o=scene3D.modelMethods.toggleCameraSE.call(this,e,null,60);o&&(o.position.y-=.7*Math.cos(60/180*Math.PI),o.position.z-=8.5*Math.cos(60/180*Math.PI),o.rotation.x=.5*Math.PI)},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("camera_ballshape",o,"摄像头","球型摄像头"),void e(o)}scene3D.loadModel("camera_ballshape",o,"摄像头","球型摄像头"),scene3D.loadObj("camera_ballshape",scene3D.setting.ctx+"/obj/camera_ballshape.obj",n,[.7,.7,.7]),scene3D.loadTex(scene3D.setting.ctx+"/img/camera_ballshape.jpg",n,function(e){scene3D.loadMat("camera_ballshape",new THREE.MeshPhongMaterial({color:"#e0f3ff",map:e,depthFunc:3,depthTest:!0,depthWrite:!0,emissive:0,morphTargets:!1,shininess:96.078431,skinning:!1,specular:8355711}))})},Scene3D.prototype.modelFileFn.camera_gunshape=function(e){var o={size:{x:1,y:1},name:{type:"camera_gunshape"},height:3,above:13,class:["obj","camera_gunshape"],once:!0,isDevice:!0,onWall:!0,rotatable:!1,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,onCreate:function(){this.castShadow=!0,this.receiveShadow=!0},afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.position.toArray().concat(.5))},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},toggleCameraSE:function(e){var o=scene3D.modelMethods.toggleCameraSE.call(this,e,null,60);o&&(o.rotation.x=-.5*Math.PI,o.position.y+=.75,o.position.z+=10*Math.cos(60/180*Math.PI))},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("camera_gunshape",o,"摄像头","枪型摄像头"),void e(o)}scene3D.loadModel("camera_gunshape",o,"摄像头","枪型摄像头"),scene3D.loadObj("camera_gunshape",scene3D.setting.ctx+"/obj/camera_gunshape.obj",n,[.2,.2,.2]),scene3D.loadTex(scene3D.setting.ctx+"/img/camera_gunshape.jpg",n,function(e){scene3D.loadMat("camera_gunshape",new THREE.MeshPhongMaterial({map:e,color:"#e0f3ff",depthFunc:3,depthTest:!0,depthWrite:!0,emissive:0,morphTargets:!1,shininess:96.078431,skinning:!1,specular:8355711}))})},Scene3D.prototype.modelFileFn.capsule1=function(e){var o={size:{x:2,y:2},name:{type:"capsule1"},height:10,class:["obj","capsule1"],capacity:16,once:!1,isDevice:!1,exceptionCapacity:{airCon_embed:1,battery_embed:1,powerSupply_embed:1},itemsCanBeAdded:["capsule1","airCon_embed","battery_embed","powerSupply_embed"],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.device.childrenList=new scene3D.ChildrenList(this.device);var e=new THREE.BoxGeometry(.1,10,4);e.setUV([[0,0],[0,0],[0,0],[0,0],[1,1],[1,0],[0,0],[0,1],[0,1],[0,0],[1,0],[1,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]),e.translate(0,0,-2);var o=scene3D.materials.material_capsuleDoor,n=new THREE.Mesh(e,o);n.name={toDelete:!0},n.position.x=2,n.position.z=2,n.rotation.y=-.8*Math.PI,this.update=function(){this.add(n);var e=this;this.device.childrenList.list.forEach(function(o){var n=scene3D.deviceToMesh[o.code];e.add(n),"airCon_embed"===o.type?(n.rotation.y=-.8*Math.PI,n.position.set(3.1,2,3.6)):"battery_embed"===o.type?(n.rotation.y=.5*Math.PI,n.position.set(0,-3,1)):"powerSupply_embed"===o.type&&(n.rotation.y=.5*Math.PI,n.position.set(0,.15,0))})},this.add(n)},showDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(this),scene3D.apply()},hideDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(!1),scene3D.apply()},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("capsule1",o,"单舱体"),void e(o)}scene3D.loadModel("capsule1",o,"单舱体");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/capsuleDoor.jpg",n,function(e){scene3D.loadMat("capsuleDoor",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.2}))}),scene3D.loadObj("capsule1",scene3D.setting.ctx+"/obj/capsule1.obj",n),scene3D.loadTex(scene3D.setting.ctx+"/img/capsule1.jpg",n,function(e){scene3D.loadMat("capsule1",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.2}))}),scene3D.recover.addRecover("allAddSymbol","v.remove(v.addSymbol); delete v.addSymbol")},Scene3D.prototype.modelFileFn.capsule2=function(e){var o={size:{x:2,y:4},name:{type:"capsule2"},height:10,class:["obj","capsule2"],capacity:16,once:!1,isDevice:!1,exceptionCapacity:{airCon_embed:2,battery_embed:4,powerSupply_embed:1},itemsCanBeAdded:["capsule2","airCon_embed","battery_embed","powerSupply_embed"],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.device.childrenList=new scene3D.ChildrenList(this.device);var e=new THREE.BoxGeometry(.1,10,4);e.translate(0,0,-2),e.setUV([[0,0],[0,0],[0,0],[0,0],[1,1],[1,0],[0,0],[0,1],[0,1],[0,0],[1,0],[1,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]);var o=scene3D.materials.material_capsuleDoor,n=new THREE.Mesh(e,o);n.name={toDelete:!0},n.position.x=2,n.position.z=3.9,n.rotation.y=-.8*Math.PI,this.add(n);var t=new THREE.Mesh(e,o);t.name={toDelete:!0},t.position.x=2,t.position.z=-3.9,t.rotation.y=-.2*Math.PI,this.add(t),this.update=function(){this.add(n),this.add(t);var e=this,o=0,i=0;this.device.childrenList.list.forEach(function(n){var t=scene3D.deviceToMesh[n.code];if(e.add(t),"airCon_embed"===n.type){switch(o){case 0:t.rotation.y=-.8*Math.PI,t.position.set(3.1,2,5.6);break;case 1:t.rotation.y=.8*Math.PI,t.position.set(3.1,2,-5.6)}o++}else if("battery_embed"===n.type){switch(t.rotation.y=.5*Math.PI,i){case 0:t.position.set(0,-3,3);break;case 1:t.position.set(0,-3,1);break;case 2:t.position.set(0,-3,-1);break;case 3:t.position.set(0,-3,-3)}i++}else"powerSupply_embed"===n.type&&(t.rotation.y=.5*Math.PI,t.position.set(0,.15,1.95))})}},showDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(this),scene3D.apply()},hideDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(!1),scene3D.apply()},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("capsule2",o,"双舱体"),void e(o)}scene3D.loadModel("capsule2",o,"双舱体");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/capsuleDoor.jpg",n,function(e){scene3D.loadMat("capsuleDoor",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.2}))}),scene3D.loadObj("capsule2",scene3D.setting.ctx+"/obj/capsule2.obj",n),scene3D.loadTex(scene3D.setting.ctx+"/img/capsule2.jpg",n,function(e){scene3D.loadMat("capsule2",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.2}))}),scene3D.recover.addRecover("allAddSymbol","v.remove(v.addSymbol); delete v.addSymbol")},Scene3D.prototype.modelFileFn.capsule3=function(e){var o={size:{x:2,y:6},name:{type:"capsule3"},height:10,class:["obj","capsule3"],capacity:16,once:!1,isDevice:!1,exceptionCapacity:{airCon_embed:3,battery_embed:4,powerSupply_embed:1},itemsCanBeAdded:["capsule3","airCon_embed","battery_embed","powerSupply_embed"],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.device.childrenList=new scene3D.ChildrenList(this.device);var e=new THREE.BoxGeometry(.1,10,4);e.setUV([[0,0],[0,0],[0,0],[0,0],[1,1],[1,0],[0,0],[0,1],[0,1],[0,0],[1,0],[1,1],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]),e.translate(0,0,-2);var o=scene3D.materials.material_capsuleDoor,n=new THREE.Mesh(e,o);n.name={toDelete:!0},n.position.x=2,n.position.z=5.7,n.rotation.y=-.8*Math.PI,this.add(n);var t=new THREE.Mesh(e,o);t.name={toDelete:!0},t.position.x=2,t.position.z=-1.9,t.rotation.y=-.4*Math.PI,this.add(t);var i=new THREE.Mesh(e,o);i.name={toDelete:!0},i.position.x=2,i.position.z=-5.7,i.rotation.y=-.2*Math.PI,this.add(i),this.update=function(){this.add(n),this.add(t),this.add(i);var e=this,o=0,s=0;this.device.childrenList.list.forEach(function(n){var t=scene3D.deviceToMesh[n.code];if(e.add(t),"airCon_embed"===n.type){switch(o){case 0:t.rotation.y=-.8*Math.PI,t.position.set(3.1,2,7.4);break;case 1:t.rotation.y=.6*Math.PI,t.position.set(3.9,2,-2.6);break;case 2:t.rotation.y=.8*Math.PI,t.position.set(3.1,2,-7.4)}o++}else if("battery_embed"===n.type){switch(t.rotation.y=.5*Math.PI,s){case 0:t.position.set(0,-3,4.8);break;case 1:t.position.set(0,-3,2.8);break;case 2:t.position.set(0,-3,.8);break;case 3:t.position.set(0,-3,-1.2)}s++}else"powerSupply_embed"===n.type&&(t.rotation.y=.5*Math.PI,t.position.set(0,.15,3.75))})}},showDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(this),scene3D.apply()},hideDeviceInfo:function(){scene3D.$scope.SetConfiguration.showDeviceInfo(!1),scene3D.apply()},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("capsule3",o,"三舱体"),void e(o)}scene3D.loadModel("capsule3",o,"三舱体");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/capsuleDoor.jpg",n,function(e){scene3D.loadMat("capsuleDoor",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.2}))}),scene3D.loadObj("capsule3",scene3D.setting.ctx+"/obj/capsule3.obj",n),scene3D.loadTex(scene3D.setting.ctx+"/img/capsule3.jpg",n,function(e){scene3D.loadMat("capsule3",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.2}))}),scene3D.recover.addRecover("allAddSymbol","v.remove(v.addSymbol); delete v.addSymbol")},Scene3D.prototype.modelFileFn.centralAircon=function(e){var o={size:{x:4,y:4},name:{type:"centralAircon"},height:2.2,above:20,class:["obj","centralAircon"],once:!1,isDevice:!0,onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("centralAircon",o,"普通空调","中央空调"),void e(o)}scene3D.loadModel("centralAircon",o,"普通空调","中央空调");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadObj("centralAircon",scene3D.setting.ctx+"/obj/centralAircon.obj",n,[.02,.02,.02]),scene3D.loadTex(scene3D.setting.ctx+"/img/centralAircon.png",n,function(e){scene3D.loadMat("centralAircon",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.distributor=function(e){var o={size:{x:2,y:2},name:{type:"distributor"},height:8,class:["obj","distributor"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}},n=new THREE.CubeGeometry(4,8,4);n.setUV([[0,0],[0,.5],[.33,.5],[.33,0],[.67,1],[.67,.5],[1,.5],[1,1],[.33,.5],[.33,0],[.66,0],[.66,.5],[0,0],[0,0],[0,0],[0,0],[0,.5],[0,1],[.33,1],[.33,.5],[0,0],[0,0],[0,0],[0,0]]);var t=new THREE.LoadingManager;switch(t.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("distributor",o,"配电柜"),void e(o)}scene3D.loadModel("distributor",o,"配电柜"),scene3D.loadGeo("distributor",n),scene3D.loadTex(scene3D.setting.ctx+"/img/distributor.jpg",t,function(e){scene3D.loadMat("distributor",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.door=function(e){var o={size:{x:9,y:1},name:{type:"door"},height:20,above:0,class:["obj","door"],once:!1,isDevice:!1,capacity:0,exceptionCapacity:{doorLock:1,doorMagnet:1},itemsCanBeAdded:["door","doorLock","doorMagnet"],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.scale.y=1.25,this.device.childrenList=new scene3D.ChildrenList(this.device),this.castShadow=!0;var e=(new THREE.TextureLoader,scene3D.geometries.geometry_door_sigle),o=scene3D.materials.material_doorGlass,n=new THREE.Mesh(e,o),t=new THREE.Mesh(e,o);n.rotation.y=-.5*Math.PI,t.rotation.y=.5*Math.PI,n.position.x-=10,t.position.x+=10;var i=scene3D.geometries.geometry_door_handle,s=scene3D.materials.material_doorHandle,a=new THREE.Mesh(i,s),c=a.clone();a.position.z=-9,c.position.z=-9,c.rotation.y=Math.PI;var r=a.clone(),d=c.clone();n.add(r),n.add(d),t.add(a),t.add(c),this.add(n),this.add(t),this.material.visible=!1,n.name=t.name={type:"toDelete"}},update:function(){var e=this.device,o=this;e.childrenList.list.forEach(function(e){var n=scene3D.deviceToMesh[e.code];"doorLock"===e.type?(n.position.set(0,0,0),n.scale.z=1,n.handle.visible=!1,o.add(n)):"doorMagnet"===e.type&&(n.position.set(0,7.5,0),n.rotation.y=.5*Math.PI,n.scale.z=10,o.add(n))})},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5),this.material.visible=!1}},n=new THREE.LoadingManager;n.onLoad=function(){e(o)};var t=new THREE.BoxGeometry(20,16,.5);switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("door",o,"门"),void e(o)}scene3D.loadModel("door",o,"门"),scene3D.loadObj("door_sigle",scene3D.setting.ctx+"/obj/door.obj",n,[.2,.16,.2]),scene3D.loadObj("door_handle",scene3D.setting.ctx+"/obj/door_handle.obj",n,[.12,.12,.12]),scene3D.loadGeo("door",t),scene3D.loadTex(scene3D.setting.ctx+"/img/door.png",n,function(e){scene3D.loadMat("doorGlass",new THREE.MeshPhongMaterial({transparent:!0,map:e,depthWrite:!1,specular:16777215,envMap:scene3D.skyboxTexture,reflectivity:.8}))}),scene3D.loadMat("door",new THREE.MeshPhongMaterial({transparent:!0,opacity:0,visible:!1})),scene3D.loadMat("doorHandle",new THREE.MeshPhongMaterial(new THREE.MeshPhongMaterial({color:"#666666",specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.8})))},Scene3D.prototype.modelFileFn.doorLock=function(e){var o={size:{x:1,y:1},name:{type:"doorLock"},height:2,above:5,class:["obj","doorLock"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,beforeMoving:function(e){e&&(e.occupied=!0)},afterSelected:function(){delete this._spec,scene3D.camera.moveTo(this.parent.position.x,this.parent.position.y,this.parent.position.z,.5)},onCreate:function(){var e=new THREE.Group,o=new THREE.Mesh(scene3D.geometries.geometry_doorLockHandle,scene3D.materials.material_doorLockHandle),n=new THREE.Mesh(scene3D.geometries.geometry_doorLockHandle,scene3D.materials.material_doorLockHandle);n.rotation.x=Math.PI,e.add(o),e.add(n),e.position.y=.4,e.name={type:"toDelete"},this.add(e),this.handle=e,this.castShadow=!0},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("doorLock",o,"非智能门禁"),void e(o)}scene3D.loadModel("doorLock",o,"非智能门禁"),scene3D.loadObj("doorLockHandle",scene3D.setting.ctx+"/obj/doorLockHandle.obj",n,[.08,.08,.08]),scene3D.loadMat("doorLockHandle",new THREE.MeshPhongMaterial({specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.8})),scene3D.loadObj("doorLock",scene3D.setting.ctx+"/obj/doorLock.obj",n,[.08,.08,.08]),scene3D.loadTex(scene3D.setting.ctx+"/img/doorLock.jpg",n,function(e){scene3D.loadMat("doorLock",new THREE.MeshPhongMaterial({specular:16777215,shininess:5,map:e,envMap:scene3D.skyboxTexture,reflectivity:.8}))})},Scene3D.prototype.modelFileFn.doorMagnet=function(e){var o={size:{x:1,y:1},name:{type:"doorMagnet"},height:1.2,above:8,class:["obj","doorMagnet"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,beforeMoving:function(e){e&&(e.occupied=!0)},afterSelected:function(){delete this._spec,scene3D.camera.moveTo(this.parent.position.x,this.parent.position.y,this.parent.position.z,.36)},onCreate:function(){this.castShadow=!0},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("doorMagnet",o,"门磁"),void e(o)}scene3D.loadModel("doorMagnet",o,"门磁"),scene3D.loadGeo("doorMagnet",new THREE.BoxGeometry(.5,1,.5)),scene3D.loadMat("doorMagnet",new THREE.MeshPhongMaterial({color:"#666666",specular:16777215,shininess:5})),e(o)},Scene3D.prototype.modelFileFn.elecMeter=function(e){var o={size:{x:1,y:1},height:3,above:0,class:["obj","elecMeter"],name:{type:"elecMeter"},once:!0,isDevice:!0,onWall:!0,rotatable:!1,beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.position.toArray().concat(.5))},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,onCreate:function(){this.castShadow=!0}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("elecMeter",o,"智能电表（交流）"),void e(o)}scene3D.loadModel("elecMeter",o,"智能电表（交流）");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadObj("elecMeter",scene3D.setting.ctx+"/obj/elecMeter.obj",n,[.009,.009,.009]),scene3D.loadTex(scene3D.setting.ctx+"/img/elecMeter.jpg",n,function(e){scene3D.loadMat("elecMeter",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.FireExtinguisher=function(e){var o={size:{x:1,y:2},name:{type:"FireExtinguisher"},height:7.68,class:["obj","FireExtinguisher"],once:!1,isDevice:!1,shadowPath:[[.6,-.3],[.42,.12],[0,.3],[-.42,.12],[-.6,-.3],[-.42,-.72],[0,-.9],[.42,-.72]],afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("FireExtinguisher",o,"灭火器"),
void e(o)}scene3D.loadModel("FireExtinguisher",o,"灭火器"),scene3D.loadObj("FireExtinguisher",scene3D.setting.ctx+"/obj/FireExtinguisher.obj",n,[1,1,1]),scene3D.loadTex(scene3D.setting.ctx+"/img/FireExtinguisher.png",n,function(e){scene3D.loadMat("FireExtinguisher",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.fireProofDoor=function(e){var o={size:{x:1,y:7},name:{type:"fireProofDoor"},height:14,above:0,class:["obj","fireProofDoor"],once:!1,isDevice:!1,capacity:0,exceptionCapacity:{doorLock:1,doorMagnet:1},itemsCanBeAdded:["fireProofDoor","doorLock","doorMagnet"],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.castShadow=!0,this.device.childrenList=new scene3D.ChildrenList(this.device)},beforeMoving:function(e){if(e){if(e.array.length<3)return;e.occupied=!1,e.array.forEach(function(o){o.occupied&&"wall"!==o.occupied.device.type&&(e.occupied=!0)})}e&&e.array[0].occupied&&"wall"===e.array[0].occupied.device.type&&(e.occupied=!1)},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},update:function(){var e=this.device,o=this;e.childrenList.list.forEach(function(e){var n=scene3D.deviceToMesh[e.code];"doorLock"===e.type?(n.position.set(0,-.8,.8),n.scale.z=5,n.handle.visible=!0,n.handle.scale.z=.2,n.handle.position.y=-.57,n.handle.children[0].position.z=1.1,n.handle.children[1].position.z=-1.1,n.rotation.y=-Math.PI/2,o.add(n)):"doorMagnet"===e.type&&(n.position.set(.3,5.9,1),n.rotation.y=0,n.scale.z=4,n.position.x=1,o.add(n))})}},n=new THREE.LoadingManager;n.onLoad=function(){e(o)};var t=new THREE.BoxGeometry(2,14,15.4);switch(t.setUV([[0,0],[.01,0],[.01,.01],[0,.01],[0,1],[0,0],[1,0],[1,1],[1,1],[1,0],[0,0],[0,1],[0,0],[.01,0],[.01,.01],[0,.01],[0,0],[.01,0],[.01,.01],[0,.01],[0,0],[.01,0],[.01,.01],[0,.01]]),scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("fireProofDoor",o,"防火门"),void e(o)}scene3D.loadModel("fireProofDoor",o,"防火门"),scene3D.loadGeo("fireProofDoor",t),scene3D.loadTex(scene3D.setting.ctx+"/img/fireProofDoor.jpg",n,function(e){scene3D.loadMat("fireProofDoor",new THREE.MeshLambertMaterial({color:"#e0f3ff",map:e,envMap:scene3D.skyboxTexture,reflectivity:.1}))})},Scene3D.prototype.modelFileFn.FOCProductionLine=function(e){var o={size:{x:Math.ceil(39),y:Math.ceil(3.5)},name:{type:"FOCProductionLine"},height:6.625,class:["obj","FOCProductionLine"],once:!1,isDevice:!1,flipable:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){this.intersectedPos?(scene3D.camera.moveTo(this.intersectedPos.x,this.intersectedPos.y,this.intersectedPos.z,.5),delete this.intersectedPos):scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},onCreate:function(){var e=this;e.wheels={list:[]};var o=0;Object.defineProperty(this.wheels,"rotation",{set:function(e){o=e,this.list.forEach(function(o){o.turnReverse?o.rotation.y=-e:o.rotation.y=e})},get:function(){return o}});var n=[];n.push(new THREE.Vector2(0,-.05),new THREE.Vector2(.365,-.05),new THREE.Vector2(.365,.05),new THREE.Vector2(0,.05),new THREE.Vector2(0,-.05));var t=new THREE.LatheGeometry(n,32,0,2*Math.PI);[[15.56,-1.175,!0],[17.055,-1.175,!0],[16.31,-2.3],[25.785,-.45],[26.685,1.045,!0],[26.68,-2.055,!0]].forEach(function(o,n){var i=0===n?new THREE.Mesh(t,scene3D.materials.material_FOCWheel2):e.wheels.list[0].clone();i.skipReverse=!0,i.position.set(o[0],o[1],1.0025),i.rotation.x=-.5*Math.PI,i.name={toDelete:!0},i.turnReverse=o[2],e.add(i),e.wheels.list[n]=i}),n=[],n.push(new THREE.Vector2(0,-.3),new THREE.Vector2(.5,-.3),new THREE.Vector2(.5,-.27),new THREE.Vector2(.3,.6*-.75*.5),new THREE.Vector2(.3,.75*.6*.5),new THREE.Vector2(.5,.27),new THREE.Vector2(.5,.3),new THREE.Vector2(0,.3),new THREE.Vector2(0,-.3)),t=new THREE.LatheGeometry(n,64,0,2*Math.PI),[[-37.08,1.09,"#232522"],[-37.08,-.145,"#B2AFAA"],[-37.08,-1.4,"#232522"],[-37.08,-2.655,"#B2AFAA"],[-35.08,1.09,"#00197B"],[-35.08,-.145,"#C43C21"],[-35.08,-1.4,"#086E1A"],[-35.08,-2.655,"#2A1712"],[-33.08,1.09,"#2A1712"],[-33.08,-.145,"#086E1A"],[-33.08,-1.4,"#00197B"],[-33.08,-2.655,"#C43C21"]].forEach(function(o,n){var i=0===n?new THREE.Mesh(t,scene3D.materials.material_FOCWheel.clone()):e.wheels.list[6].clone();i.skipReverse=n,i.children[0]&&i.remove(i.children[0]),i.position.set(o[0],o[1],.9025),i.rotation.x=-.5*Math.PI,i.name={toDelete:!0};var s=new THREE.Mesh(new THREE.CylinderBufferGeometry(.4,.4,.5,32),new THREE.MeshPhongMaterial({color:o[2],specular:16777215,shininess:10}));i.add(s),e.add(i),e.wheels.list[n+6]=i});var i=new THREE.LineDashedMaterial({color:16777215,dashSize:.8,gapSize:.2});t=new THREE.Geometry;var s=[[-31.65,-.815],[15.555,-.815],[15.67,-.835],[15.77,-.885],[15.855,-.97],[15.905,-1.07],[15.92,-1.18],[15.945,-2.3],[15.96,-2.415],[16.01,-2.515],[16.095,-2.6],[16.195,-2.65],[16.305,-2.665],[16.42,-2.65],[16.52,-2.6],[16.605,-2.515],[16.655,-2.415],[16.675,-2.3],[16.69,-1.18],[16.705,-1.07],[16.755,-.97],[16.84,-.885],[16.94,-.835],[17.055,-.815],[25.785,-.815],[25.895,-.8],[25.995,-.75],[26.08,-.665],[26.13,-.565],[26.15,-.45],[26.32,1.045],[26.335,1.155],[26.385,1.255],[26.47,1.34],[26.57,1.39],[26.685,1.41],[26.795,1.39],[26.895,1.34],[26.98,1.255],[27.03,1.155],[27.05,1.045],[27.045,-2.06],[27.025,-2.17],[26.975,-2.27],[26.89,-2.355],[26.79,-2.405],[26.68,-2.42],[26.565,-2.405],[26.465,-2.355],[26.38,-2.27],[26.33,-2.17],[26.315,-2.06],[26.32,1.045],[26.335,1.155],[26.385,1.255],[26.47,1.34],[26.57,1.39],[26.685,1.41],[33.685,1.41]];t.vertices=s.map(function(e){return new THREE.Vector3(e[0],e[1],1.0025)}),t.computeLineDistances();var a=new THREE.Line(t,i);lineStart=0,Object.defineProperty(a,"lineStart",{set:function(e){lineStart=e,this.geometry.vertices[0].x=s[0][0]+e,this.material.scale=1-e/70,this.geometry.verticesNeedUpdate=!0},get:function(){return lineStart}}),a.name={toDelete:!0},e.line=a,e.add(a);var c=Math.sqrt(3)/4*.5,r=new THREE.Shape;r.moveTo(0,0),r.lineTo(.125,-c),r.lineTo(.325,-c),r.lineTo(.45,0),r.lineTo(0,0);var d={steps:1,amount:31,bevelEnabled:!1};t=new THREE.ExtrudeGeometry(r,d);var l=new THREE.Mesh(t,new THREE.MeshPhongMaterial({color:"#846D44",transparent:!0,opacity:.6,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:1}));l.name={toDelete:!0},l.rotation.y=.5*-Math.PI,l.position.set(10.102,-.7,.77),e.add(l),e.water=l},animation:[{origin:"this.wheels",target:"rotation",from:0,to:-2*Math.PI,duration:1e3},{origin:"this.line",target:"lineStart",from:0,to:1,duration:500}]};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("FOCProductionLine",o,"光纤生产线"),void e(o)}scene3D.loadModel("FOCProductionLine",o,"光纤生产线");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/FOCProductionLine.png",n,function(e){scene3D.loadMat("FOCProductionLine",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.1}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/wheel.jpg",n,function(e){scene3D.loadMat("FOCWheel",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/wheel2.png",n,function(e){scene3D.loadMat("FOCWheel2",new THREE.MeshPhongMaterial({map:e,transparent:!0,side:THREE.DoubleSide,specular:16777215,shininess:5}))}),scene3D.loadObj("FOCProductionLine",scene3D.setting.ctx+"/obj/FOCProductionLine.obj",n,[.5,.5,.5])},Scene3D.prototype.modelFileFn.FSU=function(e){var o={size:{x:2,y:1},name:{type:"FSU"},height:3,above:0,class:["obj","FSU"],once:!0,isDevice:!0,onWall:!0,rotatable:!1,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){var e="Scene"===this.parent.type?this.position:this.parent.position;scene3D.camera.moveTo.apply(scene3D.camera,e.toArray().concat(.5)),this.parent.device&&"cabinet"===this.parent.device.type&&new TWEEN.Tween(this.position).to({x:3},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},beforeCancelSelected:function(){this.parent&&this.parent.device&&"cabinet"===this.parent.device.type&&new TWEEN.Tween(this.position).to({x:1.6},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)}},n=new THREE.BoxGeometry(3.6,2.16,.45);n.setUV([[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[1,0],[1,1],[0,1],[0,0],[0,0],[0,0],[0,0]]);var t=new THREE.LoadingManager;switch(t.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("FSU",o,"FSU"),void e(o)}scene3D.loadModel("FSU",o,"FSU"),scene3D.loadGeo("FSU",n),scene3D.loadTex(scene3D.setting.ctx+"/img/fsu.jpg",t,function(e){scene3D.loadMat("FSU",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.infraredSensor=function(e){var o={size:{x:1,y:1},name:{type:"infraredSensor"},height:4,above:0,class:["obj","infraredSensor"],once:!0,isDevice:!0,onWall:!0,rotatable:!1,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.position.toArray().concat(.5))},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("infraredSensor",o,"红外传感器"),void e(o)}scene3D.loadModel("infraredSensor",o,"红外传感器"),scene3D.loadObj("infraredSensor",scene3D.setting.ctx+"/obj/infraredSensor.obj",n,[.3,.3,.3],function(e){e.rotateY(Math.PI)}),scene3D.loadTex(scene3D.setting.ctx+"/img/infraredSensor.jpg",n,function(e){scene3D.loadMat("infraredSensor",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5}))})},Scene3D.prototype.modelFileFn.lietougui=function(e){var o={size:{x:4,y:2},name:{type:"lietougui"},height:12,class:["obj","lietougui"],once:!0,isDevice:!0,shadowPath:[[-3.2,-1.4],[3.2,-1.4],[3.2,1.4],[-3.2,1.4]],afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}},n=new THREE.CubeGeometry(6.6,12,3.4);n.setUV([[.57,1],[.57,.5],[1,.5],[1,1],[1,.5],[1,0],[.57,0],[.57,.5],[0,1],[0,0],[.56,0],[.56,1],[.57,1],[.57,.5],[1,.5],[1,1],[.6,.6],[.6,.6],[.6,.6],[.6,.6],[.6,.6],[.6,.6],[.6,.6],[.6,.6]]);var t=new THREE.LoadingManager;if(t.onLoad=function(){e()},scene3D.loadModel("lietougui",o,"列头柜"),scene3D.$scope.c>1)return void e();scene3D.loadGeo("lietougui",n),scene3D.loadTex(scene3D.setting.ctx+"/img/lietougui.jpg",t,function(e){scene3D.loadMat("lietougui",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.light=function(e){var o={size:{x:1,y:1},name:{type:"light"},height:1,above:20,class:["obj","light"],inGroup:!0,once:!1,isDevice:!1,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5),scene3D.modelMethods.toggleGroupLine.call(this,!0),scene3D.modelMethods.toggleBindingLine.call(this,!0)},beforeCancelSelected:function(){scene3D.modelMethods.toggleGroupLine.call(this,!1),scene3D.modelMethods.toggleBindingLine.call(this,!1)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("light",o,"灯"),void e(o)}scene3D.loadModel("light",o,"灯");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/light.jpg",n,function(e){scene3D.loadMat("light",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5}))}),scene3D.loadObj("light",scene3D.setting.ctx+"/obj/light.obj",n,[1,1,1])},Scene3D.prototype.modelFileFn.lightSwitch=function(e){var o={size:{x:1,y:1},name:{type:"lightSwitch"},height:1.2,above:5,class:["obj","lightSwitch"],once:!0,isDevice:!0,onWall:!0,bindWith:["light"],showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5),scene3D.modelMethods.toggleBindingLine.call(this,!0)},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},beforeCancelSelected:function(){scene3D.modelMethods.toggleBindingLine.call(this,!1)},onCreate:function(){this.castShadow=!0}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("lightSwitch",o,"智能灯控"),void e(o)}scene3D.loadModel("lightSwitch",o,"智能灯控"),scene3D.loadObj("lightSwitch",scene3D.setting.ctx+"/obj/lightSwitch.obj",n,[.5,.5,.5]),scene3D.loadMat("lightSwitch",new THREE.MeshLambertMaterial({color:"#ffffff"}))},Scene3D.prototype.modelFileFn.noticeBoard=function(e){var o={size:{x:3,y:1},name:{type:"noticeBoard"},height:2.5,class:["obj","noticeBoard"],once:!1,onWall:!0,isDevice:!1,rotatable:!1,onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("noticeBoard",o,"公告牌"),void e(o)}scene3D.loadModel("noticeBoard",o,"公告牌");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadGeo("noticeBoard",new THREE.BoxGeometry(5,8,.1)),scene3D.loadTex(scene3D.setting.ctx+"/img/noticeBoard.jpg",n,function(e){scene3D.loadMat("noticeBoard",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.PDU=function(e){var o={size:{x:2,y:1},name:{type:"PDU"},height:3,above:0,class:["obj","PDU"],once:!0,isDevice:!0,onWall:!0,rotatable:!1,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){var e="Scene"===this.parent.type?this.position:this.parent.position;scene3D.camera.moveTo.apply(scene3D.camera,e.toArray().concat(.5)),this.parent.device&&"cabinet"===this.parent.device.type&&new TWEEN.Tween(this.position).to({x:3},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},beforeCancelSelected:function(){this.parent&&this.parent.device&&"cabinet"===this.parent.device.type&&new TWEEN.Tween(this.position).to({x:1.6},500).easing(TWEEN.Easing.Sinusoidal.InOut).start()},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)}},n=new THREE.BoxGeometry(3.6,2.16,.45);n.setUV([[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[1,0],[1,1],[0,1],[0,0],[0,0],[0,0],[0,0]]);var t=new THREE.LoadingManager;switch(t.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("PDU",o,"PDU"),void e(o)}scene3D.loadModel("PDU",o,"PDU"),scene3D.loadGeo("PDU",n),scene3D.loadTex(scene3D.setting.ctx+"/img/PDU.jpg",t,function(e){scene3D.loadMat("PDU",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.plant=function(e){var o={size:{x:2,y:2},name:{type:"plant"},height:3.2,class:["obj","plant"],once:!1,isDevice:!1,shadowPath:[[1.3,0],[.92,.92],[0,1.3],[-.92,.92],[-1.3,0],[-.92,-.92],[-0,-1.3],[.92,-.92]],onCreate:function(){for(var e=(new THREE.TextureLoader,new THREE.PlaneGeometry(2.3,10)),o=(new THREE.MeshBasicMaterial({depthWrite:!1,transparent:!0,side:THREE.DoubleSide}),0);o<12;o++){var n=1;"plant2"===this.device.subType?n=2:"plant3"===this.device.subType&&(n=3);var t=o%2==0?scene3D.materials["material_plant"+n+"_1"]:scene3D.materials["material_plant"+n+"_2"],i=new THREE.Mesh(e,t);i.position.x=1*Math.cos(2*Math.PI/12*o),i.position.z=1*Math.sin(2*Math.PI/12*o),i.rotation.y=-Math.PI/6*o-Math.PI,i.position.y=5.4,i.position.y-=1.5*Math.random(),this.add(i),i.name={type:"toDelete"},this.material.dispose(),this.material=scene3D.materials.material_plant.clone()}},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.deviceList.push({name:"盆栽2",type:"盆栽",subType:"plant2"}),scene3D.$scope.deviceList.push({name:"盆栽3",type:"盆栽",subType:"plant3"}),scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("plant",o,"盆栽"),void e(o)}scene3D.loadModel("plant",o,"盆栽"),scene3D.loadTex(scene3D.setting.ctx+"/img/plant0.png",n,function(e){scene3D.loadMat("plant1_1",new THREE.MeshLambertMaterial({map:e,side:THREE.DoubleSide,transparent:!0,depthWrite:!1}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/plant1.png",n,function(e){scene3D.loadMat("plant1_2",new THREE.MeshLambertMaterial({map:e,side:THREE.DoubleSide,transparent:!0,depthWrite:!1}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/plant2-1.png",n,function(e){scene3D.loadMat("plant2_1",new THREE.MeshLambertMaterial({map:e,side:THREE.DoubleSide,transparent:!0,depthWrite:!1}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/plant2-2.png",n,function(e){scene3D.loadMat("plant2_2",new THREE.MeshLambertMaterial({map:e,side:THREE.DoubleSide,transparent:!0,depthWrite:!1}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/plant3-1.png",n,function(e){scene3D.loadMat("plant3_1",new THREE.MeshLambertMaterial({map:e,side:THREE.DoubleSide,transparent:!0,depthWrite:!1}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/plant3-2.png",n,function(e){scene3D.loadMat("plant3_2",new THREE.MeshLambertMaterial({map:e,side:THREE.DoubleSide,transparent:!0,depthWrite:!1}))}),scene3D.loadObj("plant",scene3D.setting.ctx+"/obj/plantBase.obj",n,[.08,.08,.08]),scene3D.loadTex(scene3D.setting.ctx+"/img/plantBase.jpg",n,function(e){scene3D.loadMat("plant",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.powerSupply=function(e){var o={size:{x:2,y:2},name:{type:"powerSupply"},height:12,above:0,class:["obj","powerSupply"],once:!0,isDevice:!0,shadowPath:[[-1.8,-1.7],[1.8,-1.7],[1.8,1.7],[-1.8,1.7]],showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}},n=new THREE.CubeGeometry(4,12,4);n.setUV([[0,1],[0,0],[.33,0],[.33,1],[.66,.337],[.66,0],[.34,0],[.34,.337],[.66,.337],[.66,0],[.34,0],[.34,.337],[1,1],[1,0],[.68,0],[.68,1],[.34,.34],[.34,.35],[.35,.35],[.35,.34],[.34,.34],[.34,.35],[.35,.35],[.35,.34]]);var t=new THREE.LoadingManager;switch(t.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("powerSupply",o,"开关电源"),void e(o)}scene3D.loadModel("powerSupply",o,"开关电源"),scene3D.loadGeo("powerSupply",n),scene3D.loadTex(scene3D.setting.ctx+"/img/powerSupply.jpg",t,function(e){scene3D.loadMat("powerSupply",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.powerSupply_embed=function(e){var o={size:{x:1,y:1},name:{type:"powerSupply_embed"},height:.7,above:0,class:["obj","powerSupply_embed"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,beforeMoving:function(e){e&&(e.occupied=!0)},afterSelected:function(){scene3D.camera.moveTo(this.parent.position.x,this.parent.position.y,this.parent.position.z,.5)}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("powerSupply_embed",o,"开关电源","嵌入式开关电源"),void e(o)}scene3D.loadModel("powerSupply_embed",o,"开关电源","嵌入式开关电源");var t=new THREE.BoxGeometry(3.5,.7,3.15);t.setUV([[0,1],[0,0],[1,0],[1,1],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4],[.4,.4]]),scene3D.loadGeo("powerSupply_embed",t),scene3D.loadTex(scene3D.setting.ctx+"/img/powerSupply_embed.jpg",n,function(e){scene3D.loadMat("powerSupply_embed",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.rack=function(e){var o={size:{x:10,y:4},name:{type:"rack"},height:9.4,class:["obj","rack"],once:!1,isDevice:!1,addToThis:scene3D.modelMethods.addToThis,itemsCanBeAdded:["rack"],shadowPath:[[-9.7,-3.75],[9.7,-3.75],[9.7,3.75],[-9.7,3.75]],showAddSymbol:scene3D.modelMethods.showAddSymbol,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},onCreate:function(){this.device.childrenList=new scene3D.ChildrenList(this.device),this.castShadow=!0}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("rack",o,"蓄电池机架"),void e(o)}scene3D.loadModel("rack",o,"蓄电池机架"),scene3D.loadObj("rack",scene3D.setting.ctx+"/obj/battery24.obj",n,[1.95,2,1.9]),scene3D.loadMat("rack",new THREE.MeshPhongMaterial({color:"#090909",shininess:100,specular:16777215}))},Scene3D.prototype.modelFileFn.securityDoor=function(e){var o={size:{x:1,y:3},name:{type:"securityDoor"},height:14,class:["obj","securityDoor"],once:!1,isDevice:!1,capacity:0,exceptionCapacity:{doorLock:1,doorMagnet:1},itemsCanBeAdded:["securityDoor","doorLock","doorMagnet"],showAddSymbol:scene3D.modelMethods.showAddSymbol,addToThis:scene3D.modelMethods.addToThis,onCreate:function(){this.castShadow=!0,this.device.childrenList=new scene3D.ChildrenList(this.device)},beforeMoving:function(e){if(e){if(e.array.length<3)return;e.occupied=!1,e.array.forEach(function(o){o.occupied&&"wall"!==o.occupied.device.type&&(e.occupied=!0)})}e&&e.array[0].occupied&&"wall"===e.array[0].occupied.device.type&&(e.occupied=!1)},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},update:function(){var e=this.device,o=this;e.childrenList.list.forEach(function(e){var n=scene3D.deviceToMesh[e.code];"doorLock"===e.type?(n.position.set(0,.4,-2.44),n.scale.z=5,n.handle.visible=!0,n.handle.scale.z=.2,n.handle.position.y=-.57,n.handle.children[0].position.z=1.1,n.handle.children[1].position.z=-1.1,n.rotation.y=-Math.PI/2,o.add(n)):"doorMagnet"===e.type&&(n.position.set(.3,6.2,-2.4),n.rotation.y=0,n.scale.z=4,n.position.x=1,o.add(n))})}},n=new THREE.LoadingManager;n.onLoad=function(){e(o)};var t=new THREE.BoxGeometry(2,14,7.4);switch(t.setUV([[.5,.5],[.51,.5],[.51,.51],[.5,.51],[0,1],[0,.02],[1,.02],[1,1],[1,1],[1,.02],[0,.02],[0,1],[.5,.5],[.51,.5],[.51,.51],[.5,.51],[.5,.5],[.51,.5],[.51,.51],[.5,.51],[.5,.5],[.51,.5],[.51,.51],[.5,.51]]),scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("securityDoor",o,"防盗门"),void e(o)}scene3D.loadModel("securityDoor",o,"防盗门"),scene3D.loadGeo("securityDoor",t),scene3D.loadTex(scene3D.setting.ctx+"/img/securityDoor.jpg",n,function(e){scene3D.loadMat("securityDoor",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.8}))})},Scene3D.prototype.modelFileFn.shunt=function(e){var o={size:{x:1,y:1},name:{type:"shunt"},height:1.2,above:5,class:["obj","shunt"],once:!0,isDevice:!0,onWall:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},onCreate:function(){this.castShadow=!0},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("shunt",o,"分路计量"),void e(o)}scene3D.loadModel("shunt",o,"分路计量"),scene3D.loadObj("shunt",scene3D.setting.ctx+"/obj/shunt.obj",n,[.5,.5,.5]),scene3D.loadTex(scene3D.setting.ctx+"/img/shunt.jpg",n,function(e){scene3D.loadMat("shunt",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.smokeSensor=function(e){var o={size:{x:1,y:1},name:{type:"smokeSensor"},height:2,above:20,class:["obj","smokeSensor"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=[];n.push(new THREE.Vector2(0,-.6)),n.push(new THREE.Vector2(.2,-.58)),n.push(new THREE.Vector2(.4,-.56)),n.push(new THREE.Vector2(.6,-.32)),n.push(new THREE.Vector2(.8,-.24)),n.push(new THREE.Vector2(.9,-.174)),n.push(new THREE.Vector2(.96,-.12)),n.push(new THREE.Vector2(1,0)),n.push(new THREE.Vector2(.96,.12)),n.push(new THREE.Vector2(.9,.174)),n.push(new THREE.Vector2(.8,.24)),n.push(new THREE.Vector2(.6,.32)),n.push(new THREE.Vector2(0,.4)),n.push(new THREE.Vector2(0,-.6));var t=new THREE.LatheGeometry(n,64,0,2*Math.PI),i=new THREE.LoadingManager;switch(i.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("smokeSensor",o,"烟雾传感器"),void e(o)}scene3D.loadModel("smokeSensor",o,"烟雾传感器"),scene3D.loadGeo("smokeSensor",t),scene3D.loadTex(scene3D.setting.ctx+"/img/yangan.png",i,function(e){scene3D.loadMat("smokeSensor",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.sofa=function(e){var o={size:{x:6,y:7},name:{type:"sofa"},height:4.08,class:["obj","sofa"],once:!1,isDevice:!1,shadowPaths:[[[1.3,-5.8],[4.9,-5.8],[4.9,.2],[1.3,.2]],[[-5,-6.6],[-1,-6.6],[-1,2.3],[4,2.3],[4,6.4],[-5,6.4]]],onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("sofa",o,"沙发"),void e(o)}scene3D.loadModel("sofa",o,"沙发");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadObj("sofa",scene3D.setting.ctx+"/obj/sofa.obj",n,[6,6,6]),scene3D.loadTex(scene3D.setting.ctx+"/img/sofaPack.jpg",n,function(e){scene3D.loadMat("sofa",new THREE.MeshLambertMaterial({map:e})),scene3D.loadMat("sofaTable",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.sofaChair=function(e){var o={size:{x:3,y:3},name:{type:"sofaChair"},height:6.58,class:["obj","sofaChair"],once:!1,isDevice:!1,shadowPath:[[-2,-2],[2,-2],[2,2],[-2,2]],onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("sofaChair",o,"沙发椅"),void e(o)}scene3D.loadModel("sofaChair",o,"沙发椅");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadTex(scene3D.setting.ctx+"/img/sofaPack.jpg",n,function(e){scene3D.loadMat("sofaChair",new THREE.MeshLambertMaterial({map:e}))}),scene3D.loadObj("sofaChair",scene3D.setting.ctx+"/obj/sofaChair.obj",n,[6,6,6])},Scene3D.prototype.modelFileFn.sofaTable=function(e){var o={size:{x:2,y:3},name:{type:"sofaTable"},height:2.4,class:["obj","sofaTable"],once:!1,isDevice:!1,shadowPath:[[-1.65,-1.6],[1.65,-1.6],[1.65,1.6],[-1.65,1.6]],onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("sofaTable",o,"茶几"),void e(o)}scene3D.loadModel("sofaTable",o,"茶几");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadObj("sofaTable",scene3D.setting.ctx+"/obj/sofaTable.obj",n,[6,6,6])},Scene3D.prototype.modelFileFn.superAirCon=function(e){var o={size:{x:1,y:2},name:{type:"superAirCon"},height:14,class:["obj","superAirCon"],once:!0,isDevice:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}},n=new THREE.CubeGeometry(2,14,4);n.setUV([[.61,.685],[.61,0],[.98,0],[.98,.685],[.61,.685],[.61,0],[.98,0],[.98,.685],[.02,1],[.02,0],[.57,0],[.57,1],[.61,.685],[.61,0],[.98,0],[.98,.685],[.61,.99],[.61,.689],[.98,.689],[.98,.99],[0,0],[0,0],[0,0],[0,0]]);var t=new THREE.LoadingManager;switch(t.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("superAirCon",o,"精密空调"),void e(o)}scene3D.loadModel("superAirCon",o,"精密空调"),scene3D.loadGeo("superAirCon",n),scene3D.loadTex(scene3D.setting.ctx+"/img/superAirCon.jpg",t,function(e){scene3D.loadMat("superAirCon",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.television=function(e){var o={size:{x:16,y:1},name:{type:"television"},height:16,above:2,class:["obj","television"],once:!1,isDevice:!1,onWall:!0,rotatable:!1,onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.position.toArray().concat(.5))},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("television",o,"电视"),void e(o)}scene3D.loadModel("television",o,"电视");var t=new THREE.BoxGeometry(27,16,.3);t.setUV([[0,1],[0,0],[1,0],[1,1],[0,1],[.01,1],[.01,.01],[0,.01],[0,1],[.01,1],[.01,.01],[0,.01],[0,1],[.01,1],[.01,.01],[0,.01],[0,1],[.01,1],[.01,.01],[0,.01],[0,1],[.01,1],[.01,.01],[0,.01]]),scene3D.loadGeo("television",t),scene3D.loadTex(scene3D.setting.ctx+"/img/television.jpg",n,function(e){scene3D.loadMat("television",new THREE.MeshPhongMaterial({map:e,specular:16777215,shininess:5,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.tempHumiSensor=function(e){var o={size:{x:1,y:1},name:{type:"tempHumiSensor"},height:1.2,above:5,class:["obj","tempHumiSensor"],once:!0,isDevice:!0,onWall:!0,showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},beforeMoving:function(e){scene3D.modelMethods.locateBaseOnWall(e)},onCreate:function(){this.castShadow=!0},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("tempHumiSensor",o,"温湿度传感器"),void e(o)}scene3D.loadModel("tempHumiSensor",o,"温湿度传感器"),scene3D.loadObj("tempHumiSensor",scene3D.setting.ctx+"/obj/tempHumiSensor.obj",n,[1,1,1]),scene3D.loadTex(scene3D.setting.ctx+"/img/tempHumiSensor.png",n,function(e){scene3D.loadMat("tempHumiSensor",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.trashBin=function(e){var o={size:{x:1,y:1},name:{type:"trashBin"},height:2.5,class:["obj","trashBin"],once:!1,isDevice:!1,shadowPath:[[.6,0],[.42,.42],[0,.6],[-.42,.42],[-.6,0],[-.42,-.42],[0,-.6],[.42,-.42]],onCreate:function(){this.castShadow=!0},afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)}};switch(scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("trashBin",o,"垃圾桶"),void e(o)}scene3D.loadModel("trashBin",o,"垃圾桶");var n=new THREE.LoadingManager;n.onLoad=function(){e(o)},scene3D.loadObj("trashBin",scene3D.setting.ctx+"/obj/trashBin.obj",n,[.05,.05,.05]),scene3D.loadTex(scene3D.setting.ctx+"/img/trashBin.jpg",n,function(e){scene3D.loadMat("trashBin",new THREE.MeshLambertMaterial({map:e}))})},Scene3D.prototype.modelFileFn.triangleTable=function(e){
var o={size:{x:9,y:9},height:7.42,class:["obj","triangleTable"],name:{type:"triangleTable"},once:!1,isDevice:!1,afterSelected:function(){scene3D.camera.moveTo.apply(scene3D.camera,this.position.toArray().concat(.5))},onCreate:function(){this.castShadow=!0;for(var e=this,o=new THREE.Mesh(scene3D.geometries.geometry_chair,scene3D.materials.material_chair),n=new THREE.Mesh(scene3D.geometries.geometry_computer,scene3D.materials.material_computer),t=new THREE.Mesh(scene3D.geometries.geometry_computer1,scene3D.materials.material_computer),i=new THREE.Mesh(scene3D.geometries.geometry_computer2,scene3D.materials.material_computer),s=0;s<3;s++){var a=o.clone(),c=n.clone(),r=t.clone(),d=i.clone();switch(s){case 0:a.position.set(3.6,-.6,1.5),a.rotation.set(0,1,0),c.position.set(2.3,1.4,.8),c.rotation.set(0,-2.1,0),r.position.set(2.3,1.4,.8),r.rotation.set(0,-2.1,0),d.position.set(2.3,1.4,.8),d.rotation.set(0,-2.1,0);break;case 1:a.position.set(-4.8,-.6,1.7),a.rotation.set(0,-1.1,0),c.position.set(-3.5,1.4,.9),c.rotation.set(0,2.1,0),r.position.set(-3.5,1.4,.9),r.rotation.set(0,2.1,0),d.position.set(-3.5,1.4,.9),d.rotation.set(0,2.1,0);break;case 2:a.position.set(-.7,-.6,-5.8),a.rotation.set(0,3.1,0),c.position.set(-.7,1.4,-4.1),c.rotation.set(0,0,0),r.position.set(-.7,1.4,-4.1),r.rotation.set(0,0,0),d.position.set(-.7,1.4,-4.1),d.rotation.set(0,0,0)}r.name=d.name=c.name=a.name={type:"toDelete"},e.add(a),e.add(c),e.add(r),e.add(d),a.castShadow=!0,c.castShadow=!0,r.castShadow=!0,d.castShadow=!0}}},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("triangleTable",o,"三角桌"),void e(o)}scene3D.loadModel("triangleTable",o,"三角桌"),scene3D.loadObj("triangleTable",scene3D.setting.ctx+"/obj/triangleTable.obj",n,[.09,.09,.09]),scene3D.loadObj("chair",scene3D.setting.ctx+"/obj/chair.obj",n,[.05,.05,.05]),scene3D.loadObj("computer",scene3D.setting.ctx+"/obj/computer.obj",n,[.05,.05,.05]),scene3D.loadTex(scene3D.setting.ctx+"/img/chair.jpg",n,function(e){scene3D.loadMat("chair",new THREE.MeshLambertMaterial({map:e}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/computer.jpg",n,function(e){scene3D.loadMat("computer",new THREE.MeshLambertMaterial({map:e}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/triangleTable.png",n,function(e){scene3D.loadMat("triangleTable",new THREE.MeshPhongMaterial({map:e}))})},Scene3D.prototype.modelFileFn.UPS=function(e){var o={size:{x:3,y:2},name:{type:"UPS"},height:7.8,class:["obj","UPS"],once:!0,isDevice:!0,shadowPath:[[-2.7,-1.6],[2.7,-1.6],[2.7,1.6],[-2.7,1.6]],showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},onCreate:function(){this.castShadow=!0},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("UPS",o,"UPS"),void e(o)}scene3D.loadModel("UPS",o,"UPS"),scene3D.loadObj("UPS",scene3D.setting.ctx+"/obj/UPS.obj",n,[.15,.15,.15]),scene3D.loadTex(scene3D.setting.ctx+"/img/UPS.jpg",n,function(e){scene3D.loadMat("UPS",new THREE.MeshLambertMaterial({map:e,depthFunc:3,depthTest:!0,depthWrite:!0,emissive:0,morphTargets:!1,skinning:!1,envMap:scene3D.skyboxTexture,reflectivity:.4}))})},Scene3D.prototype.modelFileFn.wall=function(e){var o=1.8,n={size:{x:1,y:1},height:10,class:["obj","wall"],name:{type:"wall"},highlightColor:scene3D.color.wallHignlight,once:!1,isDevice:!1,rotatable:!1,shadowPath:[[-o/2,-o/2],[o/2,-o/2],[o/2,o/2],[-o/2,o/2]],_hoverWall:function(e){var o=scene3D.meshs.selectedObj;o.length=0,scene3D.recover.all(),scene3D._getMousePos(e),scene3D.raycaster.setFromCamera(scene3D.mouse,scene3D.camera);var n=scene3D.raycaster.intersectObjects(o._intersectList);if(n[0]){var t=n[0].point,i=scene3D.setting.floorSize,s=scene3D.meshs.floors[Math.floor(t.x/i)][Math.floor(t.z/i)];if(s.occupied&&"wall"!==s.occupied.device.type)return;var a=o.occupiedFloor[0];if(a===s)return;var c,r=s.x-a.x,d=s.y-a.y;if(r>d&&r+d>0)c="right";else if(d+r>0&&d>r)c="down";else if(r+d<0&&d>r)c="left";else{if(!(d+r<0&&r>d))return;c="up"}var l=function(){var e,o=[s],n=function(n){e=s;do{e=e[n];var t=a.x-e.x,i=a.y-e.y;if(i===t||t===-i)break;o.push(e)}while(e[n])};return"left"===c||"right"===c?(n("up"),n("down")):"up"!==c&&"down"!==c||(n("left"),n("right")),o}();o.dir=c;for(var h=0,p=a,D=["up","right","down","left"];-1===l.indexOf(p);){if(h++,p=p[c],p.occupied&&"wall"!==p.occupied.device.type)return;if(p.occupied&&"wall"===p.occupied.device.type&&(p.occupied.occupiedFloor[0].x===p.occupied.occupiedFloor[1].x?0:1)==D.indexOf(c)%2)return}var m=function(e){var n=scene3D.setting.floorSize,t=new THREE.LineBasicMaterial({color:255,depthTest:!1}),i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(p.x*n+n/2,10,p.y*n+n/2),new THREE.Vector3(e.x*n+n/2,10,e.y*n+n/2));var s=new THREE.Line(i,t);s.name={toDelete:!0},o.lines.push(s),scene3D.scene.add(s)};o.lines.forEach(function(e){scene3D.scene.remove(e)}),o.lines.length=0,o.endList.forEach(function(e){"up"!==c&&"down"!==c||e.y!==p.y?"left"!==c&&"right"!==c||e.x!==p.x||m(e):m(e)}),o.floor=p,o.length=h;var u=i/o.geometry.parameters.width;"up"===c||"down"===c?(o.scale.x=1,o.scale.z=h*u+1,scene3D.floorMark.scale.set(1,h+1,1)):(o.scale.x=h*u+1,o.scale.z=1,scene3D.floorMark.scale.set(h+1,1,1)),o.position.x=(a.x*i+p.x*i+i)/2,o.position.z=(a.y*i+p.y*i+i)/2,scene3D.floorMark.material.color.set(scene3D.color.floorEditValid),scene3D.floorMark.position.set((a.x*i+p.x*i+i)/2,.1,(a.y*i+p.y*i+i)/2),scene3D.floorMark.show(),scene3D.recover.pushFloorMark(scene3D.floorMark),scene3D.recover.pushSampleWall(o)}},onCreate:function(){function e(){if(this.name.usedFloor){var e=JSON.parse(this.name.usedFloor),n=Math.min(e.last().x,e[0].x),t=Math.min(e.last().y,e[0].y),i=Math.max(e.last().x,e[0].x),s=Math.max(e.last().y,e[0].y);n===i?this.scale.z=((s-t)*scene3D.setting.floorSize+o)/o:this.scale.x=((i-n)*scene3D.setting.floorSize+o)/o}}if(e.call(this),scene3D.lastRotation={rotation:0,time:0},this.device.subType&&"default"!==this.device.subType)if("window"===this.device.subType){this.scale.y=2,this.material.visible=!1,this.position.y=10;var n=new THREE.CubeGeometry(o,9,o,5,1,5),t=scene3D.materials.material_window.clone(),i=new THREE.Mesh(n,t);this.add(i),i.name={type:"toDelete"},this.scale.x>this.scale.z?i.scale.set((this.scale.x-.5)/this.scale.x,i.scale.y,.5):i.scale.set(.5,i.scale.y,(this.scale.z-.5)/this.scale.z);var s=new THREE.CubeGeometry(o,.5,o),a=new THREE.Mesh(s,scene3D.materials.material_window_top);a.position.set(0,4.75,0),a.name={type:"toDelete"},a.castShadow=!0,this.add(a),a=new THREE.Mesh(s,scene3D.materials.material_window_bottom),a.position.set(0,-4.75,0),a.name={type:"toDelete"},a.castShadow=!0,this.add(a),i.castShadow=!0}else"brick"===this.device.subType?(this.scale.y=2,this.position.y=10,this.material=scene3D.materials.material_brick.clone(),this.updateMap()):"caigang"===this.device.subType&&(this.scale.y=2,this.position.y=10,this.material=scene3D.materials.material_caigang.clone(),this.updateMap());else this.scale.y=2,this.position.y=10;var c=.3;this.shadowPath=[[-o/2*this.scale.x+c,-o/2*this.scale.z+c],[o/2*this.scale.x-c,-o/2*this.scale.z+c],[o/2*this.scale.x-c,o/2*this.scale.z-c],[-o/2*this.scale.x+c,o/2*this.scale.z-c]],this.castShadow=!0},afterComfirmMov:function(){this.canExtend=!0,this.originPos=this.position.clone(),this._intersectList=[scene3D.grid],canvas.addEventListener("mousemove",this._hoverWall);var e=[];for(var o in scene3D.deviceToMesh){var n=scene3D.deviceToMesh[o];"wall"===n.device.type&&n!==this&&n.occupiedFloor&&n.occupiedFloor[0]&&(e.push(n.occupiedFloor[0]),e.push(n.occupiedFloor[n.occupiedFloor.length-1]))}this.endList=e,this.lines=[]},beforeCancelSelected:function(){if(canvas.removeEventListener("mousemove",this._hoverWall),this.canExtend&&this.floor){if(this.canExtend=!1,0===this.length)return void scene3D.operations.deleteObj(!0);var e=this.dir,o=this.occupiedFloor[0],n=this.floor,t=["down","right","up","left"],i=scene3D.setting.floorSize;this.geometry.parameters.width;do{o=o[this.dir],this.occupiedFloor.push(o),o.occupied=this}while(o!==n);scene3D.recover._sampleWall=[],scene3D.recover.all(),this.device.subType&&"brick"!==this.device.subType&&"caigang"!==this.device.subType?this.device.subType&&"window"!==this.device.subType||(t.indexOf(e)%2==0?this.children[0].scale.set(.5,this.children[0].scale.y,(this.scale.z-.5)/this.scale.z):this.children[0].scale.set((this.scale.x-.5)/this.scale.x,this.children[0].scale.y,.5),this.updateMap(),this.material.visible=!1):this.updateMap(),this.lines.forEach(function(e){scene3D.scene.remove(e)}),delete this.lines,delete this.endList}var s=this.device.model.highlightColor;this.children.forEach(function(e){"Sprite"!==e.type&&e.unHighlight(s)})},beforeMoving:function(e){e&&e.array[0].occupied&&"wall"===e.array[0].occupied.device.type&&(e.occupied=!1)},afterSelected:function(){delete this._spec,this.canExtend&&this.hideBorderLine()},applyPreBuild:function(e){var n=e.floors[1][0]-e.floors[0][0];0===n?(n=e.floors[1][1]-e.floors[0][1],this.scale.z=2*n/o+1,"window"===e.subType&&this.children[0].scale.set(.5,this.children[0].scale.y,(this.scale.z-.5)/this.scale.z)):(n=e.floors[1][0]-e.floors[0][0],this.scale.x=2*n/o+1,"window"===e.subType&&this.children[0].scale.set((this.scale.x-.5)/this.scale.x,this.children[0].scale.y,.5)),n++,this.length=n,this.canExtend=!1,this.updateMap()},updateMap:function(){if(this.material.map){var e;e=this.scale.x>this.scale.z?this.scale.x*o/16:this.scale.z*o/16;var n=this.material.map.clone();n.repeat.x=e,this.material.map.dispose(),this.material.map=n,n.needsUpdate=!0}},beforeMove:function(){return!1}},t=new THREE.LoadingManager;if(t.onLoad=function(){e()},scene3D.$scope.deviceList.push({name:"窗户",type:"墙体",subType:"window"}),scene3D.$scope.deviceList.push({name:"砖混墙体",type:"墙体",subType:"brick"}),scene3D.$scope.deviceList.push({name:"彩钢瓦墙体",type:"墙体",subType:"caigang"}),scene3D.loadModel("wall",n,"墙体"),scene3D.$scope.c>1)return void e();var i=new THREE.BoxGeometry(o,10,o);i.setUV([[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1]]),scene3D.loadGeo("wall",i),scene3D.loadTex(scene3D.setting.ctx+"/img/wall.png",t,function(e){scene3D.loadMat("wall",new THREE.MeshLambertMaterial({color:"#edf8ff",map:e}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/window.jpg",t,function(e){e.wrapS=THREE.RepeatWrapping,e.repeat.set(10,1),scene3D.loadMat("window",new THREE.MeshLambertMaterial({side:THREE.DoubleSide,transparent:!0,color:"#6FABD6",opacity:.4,depthWrite:!1,envMap:scene3D.skyboxTexture,reflectivity:.4}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/brick.jpg",t,function(e){e.wrapS=THREE.RepeatWrapping,e.repeat.set(10,1),scene3D.loadMat("brick",new THREE.MeshLambertMaterial({map:e}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/caigang.jpg",t,function(e){e.wrapS=THREE.RepeatWrapping,e.repeat.set(10,1),scene3D.loadMat("caigang",new THREE.MeshLambertMaterial({map:e,envMap:scene3D.skyboxTexture,reflectivity:.3}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/window_top.jpg",t,function(e){scene3D.loadMat("window_top",new THREE.MeshLambertMaterial({map:e,color:"#edf8ff"}))}),scene3D.loadTex(scene3D.setting.ctx+"/img/window_bottom.jpg",t,function(e){scene3D.loadMat("window_bottom",new THREE.MeshLambertMaterial({map:e,color:"#edf8ff"}))}),scene3D.recover.addRecover("sampleWall","v.scale.x = 1;v.scale.z = 1;v.position.copy(v.originPos)")},Scene3D.prototype.modelFileFn.waterSensor=function(e){var o={size:{x:1,y:1},name:{type:"waterSensor"},height:.08,class:["obj","waterSensor"],once:!0,isDevice:!0,shadowPath:[[-.43,-.15],[.43,-.15],[.43,.15],[-.43,.15]],showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo,afterSelected:function(){scene3D.camera.moveTo(this.position.x,this.position.y,this.position.z,.5)},onCreate:function(){this.castShadow=!0},showDeviceInfo:scene3D.modelMethods.showDeviceInfo,hideDeviceInfo:scene3D.modelMethods.hideDeviceInfo},n=new THREE.LoadingManager;switch(n.onLoad=function(){e(o)},scene3D.$scope.needLoad(o)){case 0:return void e(o);case 1:return scene3D.loadModel("waterSensor",o,"水浸传感器"),void e(o)}scene3D.loadModel("waterSensor",o,"水浸传感器"),scene3D.loadObj("waterSensor",scene3D.setting.ctx+"/obj/waterSensor.obj",n,[.2,.2,.2]),scene3D.loadTex(scene3D.setting.ctx+"/img/waterSensor.jpg",n,function(e){scene3D.loadMat("waterSensor",new THREE.MeshLambertMaterial({map:e}))})};