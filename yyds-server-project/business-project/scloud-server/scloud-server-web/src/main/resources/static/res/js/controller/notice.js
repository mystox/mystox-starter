scloudApp.controller("noticeController",["$scope","$rootScope","$filter","noticeService",function(o,t,e,i){function n(){if(!o.noticeQuery.startTime||!o.noticeQuery.endTime){var t=new Date;t.setDate(t.getDate()+1),o.noticeQuery.endTime=e("date")(t,"yyyy/MM/dd 00:00:00"),t.setDate(t.getDate()-30),o.noticeQuery.startTime=e("date")(t,"yyyy/MM/dd 00:00:00")}o.isLoading=!0,i.getNoticeList(o.paginationConf,o.noticeQuery,function(t){o.isLoading=!1,o.noticeList=t.list,o.paginationConf.totalItems=t.count},function(){o.isLoading=!1})}function a(){i.countUnread(function(o){t.noticeCount=o<100?o:"99+"})}$state&&($state=window.$state),$stateParams&&($stateParams=window.$stateParams),o.noticeQuery={},o.showNotice={obj:{},toModal:null,clear:null},o.addNotice={form:{},obj:{},toModal:null,execute:null,clear:null},o.isLoading=!1,o.paginationConf={currentPage:1,itemsPerPage:15,pagesLength:9,onChange:function(){}},o.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",n),o.query=function(){n()},o.reset=function(){o.noticeQuery={}},o.showNotice.toModal=function(t){i.getNotice(t.id,function(e){t.read=!0,a(),o.showNotice.obj=e,$("#showNoticeModal").modal("show")})},o.showNotice.clear=function(){$("#showNoticeModal").modal("hide"),o.showNotice.obj={}},o.addNotice.toModal=function(){$("#addNoticeModal").modal("show")},o.addNotice.execute=function(){$("#addNoticeModal").modal("hide"),i.addNotice(o.addNotice.obj,function(){o.query(),a(),o.addNotice.clear()})},o.addNotice.clear=function(){$("#addNoticeModal").modal("hide"),o.addNotice.form.$setPristine(),o.addNotice.obj={}}}]);