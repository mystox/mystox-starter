(function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},a={check:{enable:false,autoCheckTrigger:false,chkStyle:t.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},c=function(e){var t=y.getRoot(e);t.radioCheckedList=[]},i=function(e){},r=function(i){var e=i.treeObj,t=v.event;e.bind(t.CHECK,function(e,t,a,c){e.srcEvent=t;p.apply(i.callback.onCheck,[e,a,c])})},h=function(e){var t=e.treeObj,a=v.event;t.unbind(a.CHECK)},n=function(e){var t=e.target,a=y.getSetting(e.data.treeId),c="",i=null,r="",h="",n=null,k=null;if(p.eqs(e.type,"mouseover")){if(a.check.enable&&p.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+v.id.CHECK)!==null){c=p.getNodeMainDom(t).id;r="mouseoverCheck"}}else if(p.eqs(e.type,"mouseout")){if(a.check.enable&&p.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+v.id.CHECK)!==null){c=p.getNodeMainDom(t).id;r="mouseoutCheck"}}else if(p.eqs(e.type,"click")){if(a.check.enable&&p.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+v.id.CHECK)!==null){c=p.getNodeMainDom(t).id;r="checkNode"}}if(c.length>0){i=y.getNodeCache(a,c);switch(r){case"checkNode":n=f.onCheckNode;break;case"mouseoverCheck":n=f.onMouseoverCheck;break;case"mouseoutCheck":n=f.onMouseoutCheck;break}}var s={stop:r==="checkNode",node:i,nodeEventType:r,nodeEventCallback:n,treeEventType:h,treeEventCallback:k};return s},k=function(e,t,a,c,i,r,h){if(!a)return;var n=e.data.key.checked;if(typeof a[n]=="string")a[n]=p.eqs(a[n],"true");a[n]=!!a[n];a.checkedOld=a[n];if(typeof a.nocheck=="string")a.nocheck=p.eqs(a.nocheck,"true");a.nocheck=!!a.nocheck||e.check.nocheckInherit&&c&&!!c.nocheck;if(typeof a.chkDisabled=="string")a.chkDisabled=p.eqs(a.chkDisabled,"true");a.chkDisabled=!!a.chkDisabled||e.check.chkDisabledInherit&&c&&!!c.chkDisabled;if(typeof a.halfCheck=="string")a.halfCheck=p.eqs(a.halfCheck,"true");a.halfCheck=!!a.halfCheck;a.check_Child_State=-1;a.check_Focus=false;a.getCheckStatus=function(){return y.getCheckStatus(e,a)};if(e.check.chkStyle==v.radio.STYLE&&e.check.radioType==v.radio.TYPE_ALL&&a[n]){var k=y.getRoot(e);k.radioCheckedList.push(a)}},s=function(e,t,a){var c=e.data.key.checked;if(e.check.enable){y.makeChkFlag(e,t);a.push("<span ID='",t.tId,v.id.CHECK,"' class='",S.makeChkClass(e,t),"' treeNode",v.id.CHECK,t.nocheck===true?" style='display:none;'":"","></span>")}},d=function(e,i){i.checkNode=function(e,t,a,c){var i=this.setting.data.key.checked;if(e.chkDisabled===true)return;if(t!==true&&t!==false){t=!e[i]}c=!!c;if(e[i]===t&&!a){return}else if(c&&p.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],true)==false){return}if(p.uCanDo(this.setting)&&this.setting.check.enable&&e.nocheck!==true){e[i]=t;var r=N(e,v.id.CHECK,this.setting);if(a||this.setting.check.chkStyle===v.radio.STYLE)S.checkNodeRelation(this.setting,e);S.setChkClass(this.setting,r,e);S.repairParentChkClassWithSelf(this.setting,e);if(c){this.setting.treeObj.trigger(v.event.CHECK,[null,this.setting.treeId,e])}}};i.checkAllNodes=function(e){S.repairAllChk(this.setting,!!e)};i.getCheckedNodes=function(e){var t=this.setting.data.key.children;e=e!==false;return y.getTreeCheckedNodes(this.setting,y.getRoot(this.setting)[t],e)};i.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return y.getTreeChangeCheckedNodes(this.setting,y.getRoot(this.setting)[e])};i.setChkDisabled=function(e,t,a,c){t=!!t;a=!!a;c=!!c;S.repairSonChkDisabled(this.setting,e,t,c);S.repairParentChkDisabled(this.setting,e.getParentNode(),t,a)};var r=i.updateNode;i.updateNode=function(e,t){if(r)r.apply(i,arguments);if(!e||!this.setting.check.enable)return;var a=N(e,this.setting);if(a.get(0)&&p.uCanDo(this.setting)){var c=N(e,v.id.CHECK,this.setting);if(t==true||this.setting.check.chkStyle===v.radio.STYLE)S.checkNodeRelation(this.setting,e);S.setChkClass(this.setting,c,e);S.repairParentChkClassWithSelf(this.setting,e)}}},l={getRadioCheckedList:function(e){var t=y.getRoot(e).radioCheckedList;for(var a=0,c=t.length;a<c;a++){if(!y.getNodeCache(e,t[a].tId)){t.splice(a,1);a--;c--}}return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var a=e.data.key.checked,c={checked:t[a],half:t.halfCheck?t.halfCheck:e.check.chkStyle==v.radio.STYLE?t.check_Child_State===2:t[a]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0};return c},getTreeCheckedNodes:function(e,t,a,c){if(!t)return[];var i=e.data.key.children,r=e.data.key.checked,h=a&&e.check.chkStyle==v.radio.STYLE&&e.check.radioType==v.radio.TYPE_ALL;c=!c?[]:c;for(var n=0,k=t.length;n<k;n++){if(t[n].nocheck!==true&&t[n].chkDisabled!==true&&t[n][r]==a){c.push(t[n]);if(h){break}}y.getTreeCheckedNodes(e,t[n][i],a,c);if(h&&c.length>0){break}}return c},getTreeChangeCheckedNodes:function(e,t,a){if(!t)return[];var c=e.data.key.children,i=e.data.key.checked;a=!a?[]:a;for(var r=0,h=t.length;r<h;r++){if(t[r].nocheck!==true&&t[r].chkDisabled!==true&&t[r][i]!=t[r].checkedOld){a.push(t[r])}y.getTreeChangeCheckedNodes(e,t[r][c],a)}return a},makeChkFlag:function(e,t){if(!t)return;var a=e.data.key.children,c=e.data.key.checked,i=-1;if(t[a]){for(var r=0,h=t[a].length;r<h;r++){var n=t[a][r];var k=-1;if(e.check.chkStyle==v.radio.STYLE){if(n.nocheck===true||n.chkDisabled===true){k=n.check_Child_State}else if(n.halfCheck===true){k=2}else if(n[c]){k=2}else{k=n.check_Child_State>0?2:0}if(k==2){i=2;break}else if(k==0){i=0}}else if(e.check.chkStyle==v.checkbox.STYLE){if(n.nocheck===true||n.chkDisabled===true){k=n.check_Child_State}else if(n.halfCheck===true){k=1}else if(n[c]){k=n.check_Child_State===-1||n.check_Child_State===2?2:1}else{k=n.check_Child_State>0?1:0}if(k===1){i=1;break}else if(k===2&&i>-1&&r>0&&k!==i){i=1;break}else if(i===2&&k>-1&&k<2){i=1;break}else if(k>-1){i=k}}}}t.check_Child_State=i}},o={},f={onCheckNode:function(e,t){if(t.chkDisabled===true)return false;var a=y.getSetting(e.data.treeId),c=a.data.key.checked;if(p.apply(a.callback.beforeCheck,[a.treeId,t],true)==false)return true;t[c]=!t[c];S.checkNodeRelation(a,t);var i=N(t,v.id.CHECK,a);S.setChkClass(a,i,t);S.repairParentChkClassWithSelf(a,t);a.treeObj.trigger(v.event.CHECK,[e,a.treeId,t]);return true},onMouseoverCheck:function(e,t){if(t.chkDisabled===true)return false;var a=y.getSetting(e.data.treeId),c=N(t,v.id.CHECK,a);t.check_Focus=true;S.setChkClass(a,c,t);return true},onMouseoutCheck:function(e,t){if(t.chkDisabled===true)return false;var a=y.getSetting(e.data.treeId),c=N(t,v.id.CHECK,a);t.check_Focus=false;S.setChkClass(a,c,t);return true}},C={},u={checkNodeRelation:function(e,t){var a,c,i,r=e.data.key.children,h=e.data.key.checked,n=v.radio;if(e.check.chkStyle==n.STYLE){var k=y.getRadioCheckedList(e);if(t[h]){if(e.check.radioType==n.TYPE_ALL){for(c=k.length-1;c>=0;c--){a=k[c];if(a[h]&&a!=t){a[h]=false;k.splice(c,1);S.setChkClass(e,N(a,v.id.CHECK,e),a);if(a.parentTId!=t.parentTId){S.repairParentChkClassWithSelf(e,a)}}}k.push(t)}else{var s=t.parentTId?t.getParentNode():y.getRoot(e);for(c=0,i=s[r].length;c<i;c++){a=s[r][c];if(a[h]&&a!=t){a[h]=false;S.setChkClass(e,N(a,v.id.CHECK,e),a)}}}}else if(e.check.radioType==n.TYPE_ALL){for(c=0,i=k.length;c<i;c++){if(t==k[c]){k.splice(c,1);break}}}}else{if(t[h]&&(!t[r]||t[r].length==0||e.check.chkboxType.Y.indexOf("s")>-1)){S.setSonNodeCheckBox(e,t,true)}if(!t[h]&&(!t[r]||t[r].length==0||e.check.chkboxType.N.indexOf("s")>-1)){S.setSonNodeCheckBox(e,t,false)}if(t[h]&&e.check.chkboxType.Y.indexOf("p")>-1){S.setParentNodeCheckBox(e,t,true)}if(!t[h]&&e.check.chkboxType.N.indexOf("p")>-1){S.setParentNodeCheckBox(e,t,false)}}},makeChkClass:function(e,t){var a=e.data.key.checked,c=v.checkbox,i=v.radio,r="";if(t.chkDisabled===true){r=c.DISABLED}else if(t.halfCheck){r=c.PART}else if(e.check.chkStyle==i.STYLE){r=t.check_Child_State<1?c.FULL:c.PART}else{r=t[a]?t.check_Child_State===2||t.check_Child_State===-1?c.FULL:c.PART:t.check_Child_State<1?c.FULL:c.PART}var h=t.gray?" gray":"";var n=e.check.chkStyle+"_"+(t[a]?c.TRUE:c.FALSE)+"_"+r;n=t.check_Focus&&t.chkDisabled!==true?n+"_"+c.FOCUS:n;return v.className.BUTTON+" "+c.DEFAULT+" "+n+h},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===v.checkbox.STYLE){var a=e.data.key.checked,c=e.data.key.children,i=y.getRoot(e);for(var r=0,h=i[c].length;r<h;r++){var n=i[c][r];if(n.nocheck!==true&&n.chkDisabled!==true){n[a]=t}S.setSonNodeCheckBox(e,n,t)}}},repairChkClass:function(e,t){if(!t)return;y.makeChkFlag(e,t);if(t.nocheck!==true){var a=N(t,v.id.CHECK,e);S.setChkClass(e,a,t)}},repairParentChkClass:function(e,t){if(!t||!t.parentTId)return;var a=t.getParentNode();S.repairChkClass(e,a);S.repairParentChkClass(e,a)},repairParentChkClassWithSelf:function(e,t){if(!t)return;var a=e.data.key.children;if(t[a]&&t[a].length>0){S.repairParentChkClass(e,t[a][0])}else{S.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,a,c){if(!t)return;var i=e.data.key.children;if(t.chkDisabled!=a){t.chkDisabled=a}S.repairChkClass(e,t);if(t[i]&&c){for(var r=0,h=t[i].length;r<h;r++){var n=t[i][r];S.repairSonChkDisabled(e,n,a,c)}}},repairParentChkDisabled:function(e,t,a,c){if(!t)return;if(t.chkDisabled!=a&&c){t.chkDisabled=a}S.repairChkClass(e,t);S.repairParentChkDisabled(e,t.getParentNode(),a,c)},setChkClass:function(e,t,a){if(!t)return;if(a.nocheck===true){t.hide()}else{t.show()}t.attr("class",S.makeChkClass(e,a))},setParentNodeCheckBox:function(e,t,a,c){var i=e.data.key.children,r=e.data.key.checked,h=N(t,v.id.CHECK,e);if(!c)c=t;y.makeChkFlag(e,t);if(t.nocheck!==true&&t.chkDisabled!==true){t[r]=a;S.setChkClass(e,h,t);if(e.check.autoCheckTrigger&&t!=c){e.treeObj.trigger(v.event.CHECK,[null,e.treeId,t])}}if(t.parentTId){var n=true;if(!a){var k=t.getParentNode()[i];for(var s=0,d=k.length;s<d;s++){if(k[s].nocheck!==true&&k[s].chkDisabled!==true&&k[s][r]||(k[s].nocheck===true||k[s].chkDisabled===true)&&k[s].check_Child_State>0){n=false;break}}}if(n){S.setParentNodeCheckBox(e,t.getParentNode(),a,c)}}},setSonNodeCheckBox:function(e,t,a,c){if(!t)return;var i=e.data.key.children,r=e.data.key.checked,h=N(t,v.id.CHECK,e);if(!c)c=t;var n=false;if(t[i]){for(var k=0,s=t[i].length;k<s;k++){var d=t[i][k];S.setSonNodeCheckBox(e,d,a,c);if(d.chkDisabled===true)n=true}}if(t!=y.getRoot(e)&&t.chkDisabled!==true){if(n&&t.nocheck!==true){y.makeChkFlag(e,t)}if(t.nocheck!==true&&t.chkDisabled!==true){t[r]=a;if(!n)t.check_Child_State=t[i]&&t[i].length>0?a?2:0:-1}else{t.check_Child_State=-1}S.setChkClass(e,h,t);if(e.check.autoCheckTrigger&&t!=c&&t.nocheck!==true&&t.chkDisabled!==true){e.treeObj.trigger(v.event.CHECK,[null,e.treeId,t])}}}},g={tools:C,view:u,event:o,data:l};e.extend(true,e.fn.zTree.consts,t);e.extend(true,e.fn.zTree._z,g);var b=e.fn.zTree,p=b._z.tools,v=b.consts,S=b._z.view,y=b._z.data,T=b._z.event,N=p.$;y.exSetting(a);y.addInitBind(r);y.addInitUnBind(h);y.addInitCache(i);y.addInitNode(k);y.addInitProxy(n,true);y.addInitRoot(c);y.addBeforeA(s);y.addZTreeTools(d);var E=S.createNodes;S.createNodes=function(e,t,a,c,i){if(E)E.apply(S,arguments);if(!a)return;S.repairParentChkClassWithSelf(e,c)};var _=S.removeNode;S.removeNode=function(e,t){var a=t.getParentNode();if(_)_.apply(S,arguments);if(!t||!a)return;S.repairChkClass(e,a);S.repairParentChkClass(e,a)};var D=S.appendNodes;S.appendNodes=function(e,t,a,c,i,r,h){var n="";if(D){n=D.apply(S,arguments)}if(c){y.makeChkFlag(e,c)}return n}})(jQuery);