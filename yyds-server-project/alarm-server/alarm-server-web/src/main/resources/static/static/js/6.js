webpackJsonp([6],{"1zOF":function(e,t){},"8RNl":function(e,t){},z6XE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Dd8w"),i=r.n(a),n=r("//Fk"),o=r.n(n),s={name:"BatchUpdate",data:function(){var e=this,t=this;return{autoUploadUrl:"/importFile/upload",exportUrl:"",confirmVisible:!1,upgradeCount:0,list:[],rightView:1,rightIsCollapsed:!1,autoFileList:[],programFileList:[],busListAll:[],busListCustomized:[],productList:[],upgradeList:[],multiUpgradeTimeList:new Array(20).fill(0).map(function(e,t){return t+1}),upgradeForm:{name:"",businessSceneId:null,fileOrderId:"",repeatNum:"",sengine:"",smonitor:"",program:"",upSize:"",engineVerStart:"",engineVerEnd:"",programVerStart:"",programVerEnd:"",smonitorVerStart:"",smonitorVerEnd:"",fileName:""},updateProgramForm:{businessScene:null,product:[],fileVersion:null,fileName:""},updatedProgramList:[],updateProgramLoading:!1,isAddingSub:!1,newBus:"",isQueryRunningPlan:!1,upgradeDetailPagi:{currentId:null,pageSize:15,total:0,page:1,handleCurrentChange:function(t){e.upgradeDetailPagi.page=t,e.queryUpgradeDetail()},pageSizeChange:function(t){e.upgradeDetailPagi.pageSize=t,e.queryUpgradeDetail()}},autoRefreshIntervalTime:+localStorage.getItem("autoRefreshIntervalTime")||300,nodes:[],treeSetting:{check:{enable:!0,chkStyle:"checkbox",chkboxType:{Y:"ps",N:"ps"}},view:{showIcon:!1,showLine:!1,showTitle:!1,dblClickExpand:!1,fontCss:function(e,t){return!1===t.fsuState?{color:"#9A9A9A"}:{color:"#fff"}}},data:{key:{children:"children",name:"name",title:"code"}},callback:{onClick:function(e,r,a){!1===a.nocheck&&t.$refs.tree.ztreeObj.checkNode(a,!a.checked,!0,!0)},beforeCheck:function(t,r){if(0===e.curDistrict)return!0;var a=!0;return!(!r.checked&&r.level>=e.curDistrict&&function t(r){var i=r.getParentNode();if(r.level>=e.curDistrict){if(i.children.filter(function(e){return e.checked&&(2===e.check_Child_State||-1===e.check_Child_State)}).length!=i.children.length-1)return void(a=!1);t(i)}return!0}(r)&&a)}}},curDistrict:-1}},computed:{upgradeFormRules:function(){var e=function(e,t,r){t?/^([1-9]\d{0,}|\d)\.([1-9]\d{0,}|\d)\.([1-9]\d{0,}|\d)\.([1-9]\d{0,}|\d)$/.test(t)?r():r(new Error(" ")):r()},t=function(e,t,r){t?/^([1-9]\d{0,}|\d)\.([1-9]\d{0,}|\d)\.([1-9]\d{0,}|\d)$/.test(t)?r():r(new Error(" ")):r()};return{businessSceneId:{trigger:["blur","change"],validator:function(e,t,r){return t?r():r(new Error(" "))}},meanwhileUpSize:{trigger:["blur","change"],validator:function(e,t,r){return t?r():r(new Error(" "))}},engineVerStart:{trigger:["blur","change"],validator:e},engineVerEnd:{trigger:["blur","change"],validator:e},programVerStart:{trigger:["blur","change"],validator:e},programVerEnd:{trigger:["blur","change"],validator:e},smonitorVerStart:{trigger:["blur","change"],validator:t},smonitorVerEnd:{trigger:["blur","change"],validator:t},upSize:{trigger:["blur","change"],validator:function(e,t,r){return/^([1-9]\d{0,})$/.test(t)?r():r(new Error(" "))}},repeatNum:{trigger:["blur","change"],validator:function(e,t,r){return/^([1-9]\d{0,})$/.test(t)?r():r(new Error(" "))}},upSize2:{trigger:["blur","change"],validator:function(e,t,r){return/^([1-9]\d{0,}|\d)$/.test(t)?r():r(new Error(" "))}}}},updateProgramRules:function(){return{businessScene:{trigger:["blur"],validator:function(e,t,r){return t?r():r(new Error(" "))}},product:{trigger:["blur"],validator:function(e,t,r){return t?r():r(new Error(" "))}}}},programautoUploadUrl:function(){return"/program/upload?productId="+this.updateProgramForm.product.join("_")+"&businessSceneId="+this.updateProgramForm.businessScene}},methods:{getTierTree:function(){var e=this,t={nation:0,province:1,city:2,town:3};return new o.a(function(r){return e.$api.getTree().then(function(a){e.curDistrict=t[a.addressScope];e.nodes=[{name:"全部",children:a.data,open:!0}],function t(r,a){a<e.curDistrict&&(r.chkDisabled=!0,r.children.forEach(function(e){return t(e,a+1)}))}(e.nodes[0],0),console.log(e.nodes),r()})})},autoUploadSuccess:function(e){this.$message({type:e.success?"success":"error",message:e.info}),this.autoFileList=[],this.$refs.upgradeUpload.clearFiles(),this.upgradeForm.fileOrderId=e.data},programUploadSuccess:function(e){this.$message({type:e.success?"success":"error",message:e.info}),this.programGetBusList=[],this.$refs.programUpload.clearFiles(),this.updateProgramForm.fileVersion=e.data,this.updateProgramForm.fileName="",this.updateProgramLoading=!1,this.getProgramList()},manuallyUpdate:function(){var e=this,t=this.updateProgramForm.product.length,r=[];this.updateProgramForm.product.forEach(function(a){e.$api.programUpdate({businessScene:e.updateProgramForm.businessScene,product:a}).then(function(n){!function(a){if(r.push(a),0==--t){var i="",n=r.filter(function(e){return e.Result=!1});0===n.length?e.$message({type:"success",message:"更新成功"}):(i=n.map(function(t){return"义务: "+e.busListAll[e.updateProgramForm.businessScene]+", 机型: "+e.productList[t.product]+", 失败原因: "+t.Reason}).join("\n"),e.$message({type:"error",message:i}))}}(i()({product:a},JSON.parse(n.data||"{}")))})}),this.getProgramList()},upgradeUploadChanged:function(e){e.response&&!e.response.success?(this.upgradeForm.fileName="",this.$refs.upgradeUpload.clearFiles()):this.upgradeForm.fileName=e.name},programUploadBeforeUpload:function(e){return["deviceinfo.xls","signal.xlsx","soft.caf"].indexOf(e.name)<0?(this.$message({type:"error",message:"请选择正确的文件: deviceinfo.xls, signal.xlsx, 或者 soft.caf"}),!1):(this.updateProgramForm.fileName=e.name,this.updateProgramLoading=!0,!0)},getBusListAll:function(){var e=this;return this.$api.programGetBusList({isCustomize:0}).then(function(t){e.busListAll=t.data})},getBusListCustomized:function(){var e=this;return this.$api.programGetBusList({isCustomize:1}).then(function(t){e.busListCustomized=t.data})},getProductList:function(){var e=this;this.$api.programQueryProduct({}).then(function(t){e.productList=t.data})},getUpgradeList:function(){var e=this;return this.$api.autoGetList({state:this.isQueryRunningPlan?1:0}).then(function(t){t.data.forEach(function(e){e.onEdit=!1,e.editValue=e.name}),e.upgradeList=t.data})},addBus:function(){var e=this;this.$api.programSave({description:this.newBus}).then(function(){e.getBusListAll(),e.getBusListCustomized()})},confirmToUpgrade:function(){var e=this;this.$refs.upgradeForm.validate(function(t){t&&(e.upgradeForm.fileOrderId||e.$refs.tree.ztreeObj.getCheckedNodes().filter(function(e){return 3===e.level}).length?e.$api.autoUpCount({name:e.$tableFilter("dateFormatFilter")(0,0,(new Date).getTime()),businessSceneId:e.upgradeForm.businessSceneId,fileOrderId:e.upgradeForm.fileOrderId,repeatNum:e.upgradeForm.repeatNum,sengine:e.upgradeForm.sengine?1:0,smonitor:e.upgradeForm.smonitor?1:0,program:e.upgradeForm.program?1:0,upSize:e.upgradeForm.upSize||null,engineVerStart:e.upgradeForm.engineVerStart,engineVerEnd:e.upgradeForm.engineVerEnd,programVerStart:e.upgradeForm.programVerStart,programVerEnd:e.upgradeForm.programVerEnd,smonitorVerStart:e.upgradeForm.smonitorVerStart,smonitorVerEnd:e.upgradeForm.smonitorVerEnd,addressIdList:e.$refs.tree.ztreeObj.getCheckedNodes().filter(function(e){return 3===e.level}).map(function(e){return e.id}),meanwhileUpSize:e.upgradeForm.meanwhileUpSize}).then(function(t){e.confirmVisible=!0,e.upgradeCount=t.data}):e.$message({type:"warning",message:"请导入文件或者选择一个区域"}))})},upgrade:function(){var e=this;this.$refs.upgradeForm.validate(function(t){t&&e.$api.autoUpdate({name:e.$tableFilter("dateFormatFilter")(0,0,(new Date).getTime()),businessSceneId:e.upgradeForm.businessSceneId,fileOrderId:e.upgradeForm.fileOrderId,repeatNum:e.upgradeForm.repeatNum,sengine:e.upgradeForm.sengine?1:0,smonitor:e.upgradeForm.smonitor?1:0,program:e.upgradeForm.program?1:0,upSize:e.upgradeForm.upSize||null,engineVerStart:e.upgradeForm.engineVerStart,engineVerEnd:e.upgradeForm.engineVerEnd,programVerStart:e.upgradeForm.programVerStart,programVerEnd:e.upgradeForm.programVerEnd,smonitorVerStart:e.upgradeForm.smonitorVerStart,smonitorVerEnd:e.upgradeForm.smonitorVerEnd,addressIdList:e.$refs.tree.ztreeObj.getCheckedNodes().filter(function(e){return 3===e.level}).map(function(e){return e.id}),meanwhileUpSize:e.upgradeForm.meanwhileUpSize}).then(function(t){e.$refs.upgradeForm.resetFields(),e.$refs.upgradeUpload.clearFiles(),e.upgradeForm={smonitor:!1,sengine:!1,program:!1,fileName:""},e.getUpgradeList()})}),this.$api},stopUpgrade:function(e){var t=this;this.$api.autoStopPlan({id:e.id}).then(function(e){t.getUpgradeList()})},queryUpgradeDetail:function(e){var t=this;e&&(this.upgradeDetailPagi.currentId=e.id),this.upgradeDetailPagi.currentId&&this.$api.autoGetDetail({planId:this.upgradeDetailPagi.currentId,currentPage:this.upgradeDetailPagi.page,pageSize:this.upgradeDetailPagi.pageSize}).then(function(r){t.list=r.data.list,t.upgradeDetailPagi.total=r.data.count,t.exportUrl="/auto/exportCSV?planId="+e.id})},getProgramList:function(){var e=this;this.$api.programGetBusProList({}).then(function(t){e.updatedProgramList=t.data})},startEditUpgradeList:function(e){var t=this.upgradeList.indexOf(e);e.onEdit=!0,this.$nextTick(function(){document.querySelectorAll(".upload-view input.edit-name")[t].select()})},editUpgradeList:function(e){var t=this;e.editValue&&e.editValue.trim()?(e.editValue!==e.name&&this.$api.autoUpName({id:e.id,oldName:e.name,name:e.editValue}).then(function(e){t.getUpgradeList()}),e.onEdit=!1):e.onEdit=!1},addAutoRefresh:function(){var e=this;clearInterval(this.autoRefreshInterval),this.autoRefreshInterval=setInterval(function(){e.getUpgradeList().then(function(t){e.upgradeDetailPagi.currentId&&e.queryUpgradeDetail(e.upgradeList.find(function(t){return t.id===e.upgradeDetailPagi.currentId}))})},1e3*this.autoRefreshIntervalTime),localStorage.setItem("autoRefreshIntervalTime",this.autoRefreshIntervalTime)}},mounted:function(){var e=this;this.getTierTree().then(function(){e.getBusListAll(),e.getBusListCustomized(),e.getProductList(),e.getUpgradeList(),e.getProgramList()}),this.addAutoRefresh()}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{attrs:{id:"BatchUpdate"}},[r("div",{staticClass:"wrapper-container df dfh"},[r("div",{staticClass:"tree",staticStyle:{width:"232px",height:"100%"}},[r("tree",{ref:"tree",attrs:{nodes:e.nodes,setting:e.treeSetting}})],1),e._v(" "),r("div",{staticClass:"left df dfv"},[r("div",{staticClass:"query-form df"},[r("el-form",{ref:"upgradeForm",attrs:{inline:!0,model:e.upgradeForm,"label-width":"100px",rules:e.upgradeFormRules}},[r("el-form-item",{attrs:{label:"业务","label-width":"40px",prop:"businessSceneId"}},[r("el-select",{attrs:{size:"mini"},model:{value:e.upgradeForm.businessSceneId,callback:function(t){e.$set(e.upgradeForm,"businessSceneId",t)},expression:"upgradeForm.businessSceneId"}},e._l(e.busListAll,function(t,a){return r("el-option",{key:a,attrs:{label:t.description,value:t.id}},[e._v(e._s(t.description))])}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"升级个数",prop:"upSize"}},[r("el-input",{attrs:{size:"mini"},model:{value:e.upgradeForm.upSize,callback:function(t){e.$set(e.upgradeForm,"upSize",t)},expression:"upgradeForm.upSize"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"升级轮数",prop:"repeatNum"}},[r("el-input",{attrs:{size:"mini"},model:{value:e.upgradeForm.repeatNum,callback:function(t){e.$set(e.upgradeForm,"repeatNum",t)},expression:"upgradeForm.repeatNum"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"同时升级个数",prop:"meanwhileUpSize"}},[r("el-select",{attrs:{size:"mini"},model:{value:e.upgradeForm.meanwhileUpSize,callback:function(t){e.$set(e.upgradeForm,"meanwhileUpSize",t)},expression:"upgradeForm.meanwhileUpSize"}},e._l(e.multiUpgradeTimeList,function(t){return r("el-option",{key:t,attrs:{label:t,value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),r("br"),e._v(" "),r("el-form-item",{attrs:{label:"引擎","label-width":"40px"}},[r("el-form-item",{attrs:{prop:"engineVerStart"}},[r("el-input",{staticStyle:{width:"72.5px"},attrs:{size:"mini"},model:{value:e.upgradeForm.engineVerStart,callback:function(t){e.$set(e.upgradeForm,"engineVerStart",t)},expression:"upgradeForm.engineVerStart"}})],1),e._v(" "),r("span",[e._v(" - ")]),e._v(" "),r("el-form-item",{attrs:{prop:"engineVerEnd"}},[r("el-input",{staticStyle:{width:"72.5px"},attrs:{size:"mini"},model:{value:e.upgradeForm.engineVerEnd,callback:function(t){e.$set(e.upgradeForm,"engineVerEnd",t)},expression:"upgradeForm.engineVerEnd"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"适配层"}},[r("el-form-item",{attrs:{prop:"programVerStart"}},[r("el-input",{staticStyle:{width:"72.5px"},attrs:{size:"mini"},model:{value:e.upgradeForm.programVerStart,callback:function(t){e.$set(e.upgradeForm,"programVerStart",t)},expression:"upgradeForm.programVerStart"}})],1),e._v(" "),r("span",[e._v(" - ")]),e._v(" "),r("el-form-item",{attrs:{prop:"programVerEnd"}},[r("el-input",{staticStyle:{width:"72.5px"},attrs:{size:"mini"},model:{value:e.upgradeForm.programVerEnd,callback:function(t){e.$set(e.upgradeForm,"programVerEnd",t)},expression:"upgradeForm.programVerEnd"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"SMonitor"}},[r("el-form-item",{attrs:{prop:"smonitorVerStart"}},[r("el-input",{staticStyle:{width:"72.5px"},attrs:{size:"mini"},model:{value:e.upgradeForm.smonitorVerStart,callback:function(t){e.$set(e.upgradeForm,"smonitorVerStart",t)},expression:"upgradeForm.smonitorVerStart"}})],1),e._v(" "),r("span",[e._v(" - ")]),e._v(" "),r("el-form-item",{attrs:{prop:"smonitorVerEnd"}},[r("el-input",{staticStyle:{width:"72.5px"},attrs:{size:"mini"},model:{value:e.upgradeForm.smonitorVerEnd,callback:function(t){e.$set(e.upgradeForm,"smonitorVerEnd",t)},expression:"upgradeForm.smonitorVerEnd"}})],1)],1),e._v(" "),r("br"),e._v(" "),r("el-form-item",[r("el-checkbox",{model:{value:e.upgradeForm.sengine,callback:function(t){e.$set(e.upgradeForm,"sengine",t)},expression:"upgradeForm.sengine"}},[e._v("引擎")])],1),e._v(" "),r("el-form-item",[r("el-checkbox",{model:{value:e.upgradeForm.program,callback:function(t){e.$set(e.upgradeForm,"program",t)},expression:"upgradeForm.program"}},[e._v("适配层")])],1),e._v(" "),r("el-form-item",[r("el-checkbox",{model:{value:e.upgradeForm.smonitor,callback:function(t){e.$set(e.upgradeForm,"smonitor",t)},expression:"upgradeForm.smonitor"}},[e._v("SMonitor")])],1),e._v(" "),e.$hasAuth(1)?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirmToUpgrade}},[e._v("确认")]):e._e(),e._v(" "),r("el-upload",{ref:"upgradeUpload",staticClass:"upload-file no-file-list",staticStyle:{display:"inline-block"},attrs:{"on-success":e.autoUploadSuccess,"on-change":e.upgradeUploadChanged,action:e.autoUploadUrl,"file-list":e.autoFileList}},[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.upgradeForm.fileName||"导入"))])],1)],1)],1),e._v(" "),r("div",{staticClass:"list df dfv"},[r("div",{staticClass:"list-header"},[r("h3"),e._v(" "),r("div",{staticClass:"btn-group"},[e.exportUrl?r("a",{attrs:{href:e.exportUrl}},[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("导出")])],1):r("el-button",{attrs:{disabled:"",type:"primary",size:"mini"}},[e._v("导出")])],1)]),e._v(" "),r("div",{staticClass:"table-box df dfv"},[r("el-table",{attrs:{data:e.list,height:"100%"}},[r("el-table-column",{attrs:{prop:"stationName",label:"局站名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"fsuId",label:"FSU ID"}}),e._v(" "),r("el-table-column",{attrs:{prop:"serialNo",label:"出厂码"}}),e._v(" "),r("el-table-column",{attrs:{prop:"sengineVal",label:"引擎",formatter:e.$tableFilter("nullFilter")}}),e._v(" "),r("el-table-column",{attrs:{prop:"programVal",label:"适配层",formatter:e.$tableFilter("nullFilter")}}),e._v(" "),r("el-table-column",{attrs:{prop:"smonitorVal",label:"SMonitor",formatter:e.$tableFilter("nullFilter")}}),e._v(" "),r("el-table-column",{attrs:{prop:"progress",label:"进度"}})],1),e._v(" "),r("el-col",{staticClass:"toolbar",attrs:{span:24}},[r("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total, prev, pager, next,sizes, jumper","page-sizes":[10,15,50,100],"page-size":e.upgradeDetailPagi.pageSize,total:e.upgradeDetailPagi.total},on:{"current-change":e.upgradeDetailPagi.handleCurrentChange,"size-change":e.upgradeDetailPagi.pageSizeChange}})],1)],1)])]),e._v(" "),r("div",{staticClass:"right dfv",style:{width:e.rightIsCollapsed?0:"400px",marginLeft:e.rightIsCollapsed?0:"16px"}},[r("div",{staticClass:"rigth-width-fixed df dfv f1"},[r("div",{staticClass:"list-header"},[r("h3",[r("a",{style:1===e.rightView&&"color: white;",attrs:{disabled:1===e.rightView},on:{click:function(t){e.rightView=1}}},[e._v("升级计划")]),e._v("\n              |  \n            "),r("a",{style:0===e.rightView&&"color: white;",attrs:{disabled:0===e.rightView},on:{click:function(t){e.rightView=0}}},[e._v("上传适配层")])]),e._v(" "),r("el-select",{directives:[{name:"show",rawName:"v-show",value:1===e.rightView,expression:"rightView === 1"}],staticStyle:{width:"120px"},attrs:{size:"mini"},on:{input:function(t){return e.addAutoRefresh()}},model:{value:e.autoRefreshIntervalTime,callback:function(t){e.autoRefreshIntervalTime=t},expression:"autoRefreshIntervalTime"}},e._l([10,30,60,300,600,1800],function(t){return r("el-option",{key:t,attrs:{label:"轮询: "+(t<60?t+"秒":t/60+"分钟"),value:t}},[e._v(e._s(t<60?t+"秒":t/60+"分钟"))])}),1),e._v(" "),r("div",{staticClass:"btn-group"},[r("el-switch",{directives:[{name:"show",rawName:"v-show",value:1===e.rightView,expression:"rightView === 1"}],staticClass:"text-collapsed",attrs:{size:"mini",width:58,"inactive-text":"全部","active-text":"执行中","active-color":"#00B1FF","inactive-color":"#888888"},on:{input:e.getUpgradeList},model:{value:e.isQueryRunningPlan,callback:function(t){e.isQueryRunningPlan=t},expression:"isQueryRunningPlan"}})],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.rightView,expression:"rightView === 0"}],staticClass:"update-plan"},[r("div",{staticClass:"query-form"},[r("el-form",{ref:"updateProgram",attrs:{"label-position":"left",model:e.updateProgramForm,rules:e.updateProgramRules}},[r("el-form-item",{attrs:{label:"业务","label-width":"50px",prop:"businessScene"}},[r("div",{staticClass:"ofh",staticStyle:{display:"inline-block",height:"40px",width:"160px",overflow:"hidden","vertical-align":"middle"}},[r("el-select",{directives:[{name:"show",rawName:"v-show",value:!e.isAddingSub,expression:"!isAddingSub"}],attrs:{size:"mini"},model:{value:e.updateProgramForm.businessScene,callback:function(t){e.$set(e.updateProgramForm,"businessScene",t)},expression:"updateProgramForm.businessScene"}},e._l(e.busListCustomized,function(t,a){return r("el-option",{key:a,attrs:{label:t.description,value:t.id}},[e._v(e._s(t.description))])}),1),e._v(" "),r("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isAddingSub,expression:"isAddingSub"}],attrs:{size:"mini"},model:{value:e.newBus,callback:function(t){e.newBus=t},expression:"newBus"}})],1),e._v(" "),e.isAddingSub?e._e():r("a",{directives:[{name:"show",rawName:"v-show",value:e.$hasAuth(4),expression:"$hasAuth(4)"}],on:{click:function(t){e.isAddingSub=!0}}},[e._v("添加")]),e._v(" "),e.isAddingSub?r("a",{staticClass:"el-icon-success",on:{click:function(t){e.newBus&&(e.isAddingSub=!1,e.addBus(),e.newBus="")}}}):e._e(),e._v(" "),e.isAddingSub?r("a",{staticClass:"el-icon-error",on:{click:function(t){e.isAddingSub=!1,e.newBus=""}}}):e._e()]),e._v(" "),r("el-form-item",{attrs:{label:"机型","label-width":"50px",prop:"product"}},[r("el-select",{attrs:{size:"mini",multiple:"","collapse-tags":""},model:{value:e.updateProgramForm.product,callback:function(t){e.$set(e.updateProgramForm,"product",t)},expression:"updateProgramForm.product"}},e._l(e.productList,function(t,a){return r("el-option",{key:a,attrs:{label:t.description,value:t.id}},[e._v(e._s(t.description))])}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"适配层文件"}},[r("br"),e._v(" "),r("el-input",{staticStyle:{"margin-left":"50px"},attrs:{size:"mini",readonly:""},model:{value:e.updateProgramForm.fileName,callback:function(t){e.$set(e.updateProgramForm,"fileName",t)},expression:"updateProgramForm.fileName"}})],1),e._v(" "),r("el-form-item",[r("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.$hasAuth(3),expression:"$hasAuth(3)"}],ref:"programUpload",staticClass:"upload-file no-file-list",staticStyle:{display:"inline-block"},attrs:{prop:"fileVersion",disabled:!(e.updateProgramForm.product.length>0&&null!=e.updateProgramForm.businessScene)||e.updateProgramLoading,"on-success":e.programUploadSuccess,"before-upload":e.programUploadBeforeUpload,action:e.programautoUploadUrl,"file-list":e.programFileList}},[r("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"mini",disabled:!(e.updateProgramForm.product.length>0&&null!=e.updateProgramForm.businessScene)||e.updateProgramLoading,type:"primary",loading:e.updateProgramLoading}},[e._v("导入")])],1),e._v(" "),r("el-button",{attrs:{size:"mini",type:"primary",disabled:!(e.updateProgramForm.product.length>0&&null!=e.updateProgramForm.businessScene)},on:{click:e.manuallyUpdate}},[e._v("更新")])],1)],1)],1),e._v(" "),r("div",{staticClass:"table-box"},[r("table",{staticClass:"primal",attrs:{border:"1"}},[e._m(0),e._v(" "),e._l(e.updatedProgramList,function(t,a){return r("tr",{key:a},[r("td",[e._v("\n                  "+e._s(t.businessName)+"\n                ")]),e._v(" "),r("td",[e._v("\n                  "+e._s(t.productName)+"\n                ")])])})],2)])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.rightView,expression:"rightView === 1"}],staticClass:"upload-view df dfv f1"},[r("div",{staticClass:"table-box df dfv f1"},[r("el-table",{attrs:{data:e.upgradeList,height:"100%","row-class-name":function(t){return t.row.id===e.upgradeDetailPagi.currentId?"hover-row":""},"row-style":{cursor:"pointer"}},on:{"row-click":function(t){e.upgradeDetailPagi.page=1,e.queryUpgradeDetail(arguments[0])}}},[r("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{directives:[{name:"show",rawName:"v-show",value:!t.row.onEdit,expression:"!scope.row.onEdit"}],on:{click:function(r){return r.stopPropagation(),e.startEditUpgradeList(t.row)}}},[e._v(e._s(t.row.name))]),e._v(" "),r("input",{directives:[{name:"show",rawName:"v-show",value:t.row.onEdit,expression:"scope.row.onEdit"},{name:"model",rawName:"v-model",value:t.row.editValue,expression:"scope.row.editValue"}],staticClass:"edit-name",attrs:{type:"text"},domProps:{value:t.row.editValue},on:{click:function(e){return e.stopPropagation(),e},blur:function(r){return e.editUpgradeList(t.row)},input:function(r){r.target.composing||e.$set(t.row,"editValue",r.target.value)}}})]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"userName",label:"发起人"}}),e._v(" "),r("el-table-column",{attrs:{prop:"ctime",label:"时间",width:"110",formatter:e.$tableFilter("dateFormatFilter")}}),e._v(" "),r("el-table-column",{attrs:{prop:"",label:"操作",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$hasAuth(2)?r("i",{staticClass:"stop-update",class:!t.row.state&&"disabled",attrs:{title:"停止"},on:{click:function(r){r.stopPropagation(),t.row.state&&e.stopUpgrade(t.row)}}}):e._e()]}}])})],1)],1)])]),e._v(" "),r("div",{staticClass:"panle-toggle panle-toggle-h",style:{left:e.rightIsCollapsed?"-20px":"-10px"},on:{click:function(t){e.rightIsCollapsed=!e.rightIsCollapsed}}},[r("i",{staticClass:"ic",class:e.rightIsCollapsed?"ic-angle-left":"ic-angle-right"})])])]),e._v(" "),r("el-dialog",{staticClass:"m400",attrs:{title:"确认升级",visible:e.confirmVisible}},[e._v("\n    您此次升级的总数是: "+e._s(Math.min(e.upgradeCount,e.upgradeForm.upSize))+"\n    "),r("br"),e._v("\n    升级的业务是: "+e._s((e.busListAll.find(function(t){return t.id===e.upgradeForm.businessSceneId})||{description:"-"}).description)+"\n\n    "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"default"},on:{click:function(t){e.confirmVisible=!1}}},[e._v("取 消")]),e._v(" "),e.upgradeCount?r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmVisible=!1,e.upgrade()}}},[e._v("升 级")]):e._e()],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("th",[this._v("业务")]),this._v(" "),t("th",[this._v("机型")])])}]};var u=r("VU/8")(s,l,!1,function(e){r("8RNl"),r("1zOF")},"data-v-6284b4ce",null);t.default=u.exports}});
//# sourceMappingURL=6.js.map